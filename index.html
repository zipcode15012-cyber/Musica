<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Player</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
            transition: background 0.4s ease, color 0.4s ease;
            overflow: hidden;
        }

        /* Theme Variables */
        /* Purple */
        body.dark.purple {
            --primary: #8b5cf6;
            --primary-light: #a78bfa;
            --primary-dark: #7c3aed;
            --background: #0f0a1a;
            --surface: #1a1228;
            --surface-elevated: #251a35;
            --text: #f3f4f6;
            --text-secondary: #9ca3af;
            --border: #2d2440;
            --hover: #2a1f3d;
            --accent: #ec4899;
        }

        body.light.purple {
            --primary: #7c3aed;
            --primary-light: #a78bfa;
            --primary-dark: #6d28d9;
            --background: #faf9fc;
            --surface: #ffffff;
            --surface-elevated: #f8f7fb;
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #e5e7eb;
            --hover: #f3f0ff;
            --accent: #ec4899;
        }

        /* Blue */
        body.dark.blue {
            --primary: #3b82f6;
            --primary-light: #60a5fa;
            --primary-dark: #2563eb;
            --background: #0a0f1a;
            --surface: #111827;
            --surface-elevated: #1e293b;
            --text: #f3f4f6;
            --text-secondary: #94a3b8;
            --border: #1e293b;
            --hover: #1e3a5f;
            --accent: #06b6d4;
        }

        body.light.blue {
            --primary: #3b82f6;
            --primary-light: #60a5fa;
            --primary-dark: #2563eb;
            --background: #f8fafc;
            --surface: #ffffff;
            --surface-elevated: #f1f5f9;
            --text: #1f2937;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --hover: #eff6ff;
            --accent: #06b6d4;
        }

        /* Green */
        body.dark.green {
            --primary: #10b981;
            --primary-light: #34d399;
            --primary-dark: #059669;
            --background: #0a1410;
            --surface: #0f1f18;
            --surface-elevated: #1a2e23;
            --text: #f3f4f6;
            --text-secondary: #94a3b8;
            --border: #1e3a2d;
            --hover: #1a3329;
            --accent: #fbbf24;
        }

        body.light.green {
            --primary: #10b981;
            --primary-light: #34d399;
            --primary-dark: #059669;
            --background: #f7fcf9;
            --surface: #ffffff;
            --surface-elevated: #f0fdf4;
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #d1fae5;
            --hover: #ecfdf5;
            --accent: #f59e0b;
        }

        /* Red */
        body.dark.red {
            --primary: #ef4444;
            --primary-light: #f87171;
            --primary-dark: #dc2626;
            --background: #1a0a0a;
            --surface: #1f1212;
            --surface-elevated: #2d1a1a;
            --text: #f3f4f6;
            --text-secondary: #9ca3af;
            --border: #3d2626;
            --hover: #331d1d;
            --accent: #fb923c;
        }

        body.light.red {
            --primary: #ef4444;
            --primary-light: #f87171;
            --primary-dark: #dc2626;
            --background: #fef8f8;
            --surface: #ffffff;
            --surface-elevated: #fef2f2;
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #fee2e2;
            --hover: #fef2f2;
            --accent: #fb923c;
        }

        /* Orange */
        body.dark.orange {
            --primary: #f97316;
            --primary-light: #fb923c;
            --primary-dark: #ea580c;
            --background: #1a0f0a;
            --surface: #1f1612;
            --surface-elevated: #2d211a;
            --text: #f3f4f6;
            --text-secondary: #9ca3af;
            --border: #3d2e26;
            --hover: #33251d;
            --accent: #fbbf24;
        }

        body.light.orange {
            --primary: #f97316;
            --primary-light: #fb923c;
            --primary-dark: #ea580c;
            --background: #fffbf5;
            --surface: #ffffff;
            --surface-elevated: #fff7ed;
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #fed7aa;
            --hover: #ffedd5;
            --accent: #eab308;
        }

        /* Pink */
        body.dark.pink {
            --primary: #ec4899;
            --primary-light: #f472b6;
            --primary-dark: #db2777;
            --background: #1a0a14;
            --surface: #1f1218;
            --surface-elevated: #2d1a25;
            --text: #f3f4f6;
            --text-secondary: #9ca3af;
            --border: #3d2638;
            --hover: #331d2d;
            --accent: #a855f7;
        }

        body.light.pink {
            --primary: #ec4899;
            --primary-light: #f472b6;
            --primary-dark: #db2777;
            --background: #fef5fb;
            --surface: #ffffff;
            --surface-elevated: #fdf2f8;
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #fce7f3;
            --hover: #fce7f3;
            --accent: #c084fc;
        }

        /* Midnight Sky */
        body.dark.midnight {
            --primary: #6366f1;
            --primary-light: #818cf8;
            --primary-dark: #4f46e5;
            --background: linear-gradient(135deg, #0a0e27 0%, #1a1f4d 50%, #0f1333 100%);
            --surface: linear-gradient(135deg, #111633 0%, #1e2555 100%);
            --surface-elevated: linear-gradient(135deg, #1a2044 0%, #252d66 100%);
            --text: #e0e7ff;
            --text-secondary: #a5b4fc;
            --border: #2d3655;
            --hover: rgba(101, 102, 241, 0.15);
            --accent: #fbbf24;
        }

        body.light.midnight {
            --primary: #4f46e5;
            --primary-light: #6366f1;
            --primary-dark: #4338ca;
            --background: linear-gradient(135deg, #eef2ff 0%, #ddd6fe 50%, #e0e7ff 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #f5f3ff 100%);
            --surface-elevated: linear-gradient(135deg, #e0e7ff 0%, #ddd6fe 100%);
            --text: #1e1b4b;
            --text-secondary: #4338ca;
            --border: #c7d2fe;
            --hover: rgba(99, 102, 241, 0.1);
            --accent: #f59e0b;
        }

        /* Sunrise */
        body.dark.sunrise {
            --primary: #f59e0b;
            --primary-light: #fbbf24;
            --primary-dark: #d97706;
            --background: linear-gradient(135deg, #1a0f0a 0%, #3d1a0a 50%, #2d1506 100%);
            --surface: linear-gradient(135deg, #2d1a12 0%, #4d2515 100%);
            --surface-elevated: linear-gradient(135deg, #3d2518 0%, #5d3520 100%);
            --text: #fef3c7;
            --text-secondary: #fcd34d;
            --border: #4d3320;
            --hover: rgba(251, 191, 36, 0.15);
            --accent: #fb923c;
        }

        body.light.sunrise {
            --primary: #f59e0b;
            --primary-light: #fbbf24;
            --primary-dark: #d97706;
            --background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 50%, #fde68a 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fffbeb 100%);
            --surface-elevated: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            --text: #78350f;
            --text-secondary: #b45309;
            --border: #fde68a;
            --hover: rgba(251, 191, 36, 0.1);
            --accent: #f97316;
        }

        /* Dawn */
        body.dark.dawn {
            --primary: #f472b6;
            --primary-light: #f9a8d4;
            --primary-dark: #ec4899;
            --background: linear-gradient(135deg, #1a0f17 0%, #2d1a27 50%, #3d1537 100%);
            --surface: linear-gradient(135deg, #2d1a27 0%, #4d2547 100%);
            --surface-elevated: linear-gradient(135deg, #3d2537 0%, #5d3557 100%);
            --text: #fae8ff;
            --text-secondary: #f0abfc;
            --border: #4d3347;
            --hover: rgba(249, 168, 212, 0.15);
            --accent: #fbbf24;
        }

        body.light.dawn {
            --primary: #ec4899;
            --primary-light: #f472b6;
            --primary-dark: #db2777;
            --background: linear-gradient(135deg, #fef5fb 0%, #fce7f3 50%, #fae8ff 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%);
            --surface-elevated: linear-gradient(135deg, #fae8ff 0%, #f5d0fe 100%);
            --text: #831843;
            --text-secondary: #be185d;
            --border: #f9a8d4;
            --hover: rgba(236, 72, 153, 0.1);
            --accent: #f59e0b;
        }

        /* Sunset */
        body.dark.sunset {
            --primary: #dc2626;
            --primary-light: #f87171;
            --primary-dark: #b91c1c;
            --background: linear-gradient(135deg, #1a0a0f 0%, #2d1218 50%, #4d0a15 100%);
            --surface: linear-gradient(135deg, #2d1218 0%, #4d1a25 100%);
            --surface-elevated: linear-gradient(135deg, #3d1a25 0%, #5d2235 100%);
            --text: #fef2f2;
            --text-secondary: #fca5a5;
            --border: #4d2633;
            --hover: rgba(248, 113, 113, 0.15);
            --accent: #fb923c;
        }

        body.light.sunset {
            --primary: #dc2626;
            --primary-light: #ef4444;
            --primary-dark: #b91c1c;
            --background: linear-gradient(135deg, #fff5f5 0%, #fee2e2 50%, #fecaca 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fef2f2 100%);
            --surface-elevated: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            --text: #7f1d1d;
            --text-secondary: #991b1b;
            --border: #fecaca;
            --hover: rgba(220, 38, 38, 0.1);
            --accent: #f97316;
        }

        /* Afternoon */
        body.dark.afternoon {
            --primary: #14b8a6;
            --primary-light: #2dd4bf;
            --primary-dark: #0d9488;
            --background: linear-gradient(135deg, #0a1a1a 0%, #0f2d2d 50%, #0d2424 100%);
            --surface: linear-gradient(135deg, #122e2e 0%, #1a4444 100%);
            --surface-elevated: linear-gradient(135deg, #1a3e3e 0%, #255555 100%);
            --text: #ccfbf1;
            --text-secondary: #5eead4;
            --border: #2d4e4e;
            --hover: rgba(45, 212, 191, 0.15);
            --accent: #fbbf24;
        }

        body.light.afternoon {
            --primary: #14b8a6;
            --primary-light: #2dd4bf;
            --primary-dark: #0d9488;
            --background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 50%, #99f6e4 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #f0fdfa 100%);
            --surface-elevated: linear-gradient(135deg, #ccfbf1 0%, #99f6e4 100%);
            --text: #134e4a;
            --text-secondary: #0f766e;
            --border: #99f6e4;
            --hover: rgba(20, 184, 166, 0.1);
            --accent: #f59e0b;
        }

        /* Christmas */
        body.dark.christmas {
            --primary: #dc2626;
            --primary-light: #ef4444;
            --primary-dark: #b91c1c;
            --background: linear-gradient(135deg, #0f1a14 0%, #1a2520 50%, #0d3320 100%);
            --surface: linear-gradient(135deg, #1a2520 0%, #2d3f35 100%);
            --surface-elevated: linear-gradient(135deg, #253530 0%, #354f45 100%);
            --text: #ffffff;
            --text-secondary: #cbd5e0;
            --border: #2d4a3a;
            --hover: rgba(239, 68, 68, 0.15);
            --accent: #10b981;
        }

        body.light.christmas {
            --primary: #dc2626;
            --primary-light: #ef4444;
            --primary-dark: #b91c1c;
            --background: linear-gradient(135deg, #fef9f3 0%, #fef2f2 50%, #f0fdf4 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fef2f2 100%);
            --surface-elevated: linear-gradient(135deg, #fee2e2 0%, #dcfce7 100%);
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #fde8e8;
            --hover: rgba(220, 38, 38, 0.1);
            --accent: #10b981;
        }

        /* Halloween */
        body.dark.halloween {
            --primary: #f97316;
            --primary-light: #fb923c;
            --primary-dark: #ea580c;
            --background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 50%, #2d0a0a 100%);
            --surface: linear-gradient(135deg, #1a1a1a 0%, #2a1a2a 100%);
            --surface-elevated: linear-gradient(135deg, #2a2a2a 0%, #3a2a3a 100%);
            --text: #ffffff;
            --text-secondary: #a0aec0;
            --border: #3d3d3d;
            --hover: rgba(251, 146, 60, 0.15);
            --accent: #a855f7;
        }

        body.light.halloween {
            --primary: #f97316;
            --primary-light: #fb923c;
            --primary-dark: #ea580c;
            --background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 50%, #fae8ff 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fff7ed 100%);
            --surface-elevated: linear-gradient(135deg, #ffedd5 0%, #f3e8ff 100%);
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #fed7aa;
            --hover: rgba(249, 115, 22, 0.1);
            --accent: #c084fc;
        }

        /* Valentine's Day */
        body.dark.valentine {
            --primary: #ec4899;
            --primary-light: #f472b6;
            --primary-dark: #db2777;
            --background: linear-gradient(135deg, #1a0a14 0%, #2d1525 50%, #3d0a1a 100%);
            --surface: linear-gradient(135deg, #2d1525 0%, #4d2540 100%);
            --surface-elevated: linear-gradient(135deg, #3d2035 0%, #5d3050 100%);
            --text: #ffffff;
            --text-secondary: #fbbf24;
            --border: #4a2638;
            --hover: rgba(244, 114, 182, 0.15);
            --accent: #f87171;
        }

        body.light.valentine {
            --primary: #ec4899;
            --primary-light: #f472b6;
            --primary-dark: #db2777;
            --background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 50%, #fee2e2 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%);
            --surface-elevated: linear-gradient(135deg, #fce7f3 0%, #fecaca 100%);
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #fbcfe8;
            --hover: rgba(236, 72, 153, 0.1);
            --accent: #ef4444;
        }

        /* St. Patrick's Day */
        body.dark.stpatricks {
            --primary: #10b981;
            --primary-light: #34d399;
            --primary-dark: #059669;
            --background: linear-gradient(135deg, #0a1410 0%, #0f1f18 50%, #0a2814 100%);
            --surface: linear-gradient(135deg, #0f1f18 0%, #1a3325 100%);
            --surface-elevated: linear-gradient(135deg, #1a2e23 0%, #254d37 100%);
            --text: #ffffff;
            --text-secondary: #cbd5e0;
            --border: #266d4a;
            --hover: rgba(52, 211, 153, 0.15);
            --accent: #fbbf24;
        }

        body.light.stpatricks {
            --primary: #10b981;
            --primary-light: #34d399;
            --primary-dark: #059669;
            --background: linear-gradient(135deg, #f0fdf4 0%, #d1fae5 50%, #a7f3d0 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
            --surface-elevated: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #a7f3d0;
            --hover: rgba(16, 185, 129, 0.1);
            --accent: #fbbf24;
        }

        /* Easter */
        body.dark.easter {
            --primary: #c084fc;
            --primary-light: #d8b4fe;
            --primary-dark: #a855f7;
            --background: linear-gradient(135deg, #1a0f1a 0%, #2d1a2d 50%, #3d1a3d 100%);
            --surface: linear-gradient(135deg, #2d1a2d 0%, #4d2a4d 100%);
            --surface-elevated: linear-gradient(135deg, #3d253d 0%, #5d355d 100%);
            --text: #fef3ff;
            --text-secondary: #e9d5ff;
            --border: #4d334d;
            --hover: rgba(216, 180, 254, 0.15);
            --accent: #fbbf24;
        }

        body.light.easter {
            --primary: #c084fc;
            --primary-light: #d8b4fe;
            --primary-dark: #a855f7;
            --background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 50%, #e9d5ff 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #faf5ff 100%);
            --surface-elevated: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
            --text: #581c87;
            --text-secondary: #7e22ce;
            --border: #e9d5ff;
            --hover: rgba(192, 132, 252, 0.1);
            --accent: #fbbf24;
        }

        /* 4th of July */
        body.dark.july4 {
            --primary: #3b82f6;
            --primary-light: #60a5fa;
            --primary-dark: #2563eb;
            --background: linear-gradient(135deg, #0a0f1a 0%, #1a1f2e 50%, #0f1a33 100%);
            --surface: linear-gradient(135deg, #1a1f2e 0%, #2a3355 100%);
            --surface-elevated: linear-gradient(135deg, #252d44 0%, #354566 100%);
            --text: #ffffff;
            --text-secondary: #cbd5e0;
            --border: #2d3655;
            --hover: rgba(96, 165, 250, 0.15);
            --accent: #dc2626;
        }

        body.light.july4 {
            --primary: #3b82f6;
            --primary-light: #60a5fa;
            --primary-dark: #2563eb;
            --background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 50%, #fee2e2 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #eff6ff 100%);
            --surface-elevated: linear-gradient(135deg, #dbeafe 0%, #fee2e2 100%);
            --text: #1f2937;
            --text-secondary: #6b7280;
            --border: #bfdbfe;
            --hover: rgba(59, 130, 246, 0.1);
            --accent: #dc2626;
        }

        /* Ocean Wave */
        body.dark.ocean {
            --primary: #06b6d4;
            --primary-light: #22d3ee;
            --primary-dark: #0891b2;
            --background: linear-gradient(135deg, #0a1a1f 0%, #0d2d3d 50%, #0a1f2e 100%);
            --surface: linear-gradient(135deg, #0f2d3d 0%, #1a4a5a 100%);
            --surface-elevated: linear-gradient(135deg, #1a3f4f 0%, #256575 100%);
            --text: #e0f2fe;
            --text-secondary: #67e8f9;
            --border: #164e63;
            --hover: rgba(34, 211, 238, 0.15);
            --accent: #fbbf24;
        }

        body.light.ocean {
            --primary: #0891b2;
            --primary-light: #06b6d4;
            --primary-dark: #0e7490;
            --background: linear-gradient(135deg, #ecfeff 0%, #cffafe 50%, #a5f3fc 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #f0fdfa 100%);
            --surface-elevated: linear-gradient(135deg, #cffafe 0%, #a5f3fc 100%);
            --text: #164e63;
            --text-secondary: #0e7490;
            --border: #a5f3fc;
            --hover: rgba(6, 182, 212, 0.1);
            --accent: #f59e0b;
        }

        /* Forest Green */
        body.dark.forest {
            --primary: #059669;
            --primary-light: #10b981;
            --primary-dark: #047857;
            --background: linear-gradient(135deg, #0a1410 0%, #0d1f18 50%, #0a2814 100%);
            --surface: linear-gradient(135deg, #0f2e1f 0%, #1a4a30 100%);
            --surface-elevated: linear-gradient(135deg, #1a3e28 0%, #256540 100%);
            --text: #d1fae5;
            --text-secondary: #6ee7b7;
            --border: #065f46;
            --hover: rgba(16, 185, 129, 0.15);
            --accent: #fbbf24;
        }

        body.light.forest {
            --primary: #059669;
            --primary-light: #10b981;
            --primary-dark: #047857;
            --background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 50%, #bbf7d0 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
            --surface-elevated: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
            --text: #065f46;
            --text-secondary: #047857;
            --border: #bbf7d0;
            --hover: rgba(5, 150, 105, 0.1);
            --accent: #f59e0b;
        }

        /* Neon Cyberpunk */
        body.dark.neon {
            --primary: #a855f7;
            --primary-light: #c084fc;
            --primary-dark: #9333ea;
            --background: linear-gradient(135deg, #0a0a0f 0%, #1a0a1f 50%, #0f0a1a 100%);
            --surface: linear-gradient(135deg, #1a0f2e 0%, #2a1545 100%);
            --surface-elevated: linear-gradient(135deg, #2a1a3e 0%, #3a2555 100%);
            --text: #faf5ff;
            --text-secondary: #e9d5ff;
            --border: #581c87;
            --hover: rgba(192, 132, 252, 0.15);
            --accent: #22d3ee;
        }

        body.light.neon {
            --primary: #9333ea;
            --primary-light: #a855f7;
            --primary-dark: #7e22ce;
            --background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 50%, #e9d5ff 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fdf4ff 100%);
            --surface-elevated: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
            --text: #581c87;
            --text-secondary: #7e22ce;
            --border: #e9d5ff;
            --hover: rgba(147, 51, 234, 0.1);
            --accent: #06b6d4;
        }

        /* Pastel Dream */
        body.dark.pastel {
            --primary: #f472b6;
            --primary-light: #f9a8d4;
            --primary-dark: #ec4899;
            --background: linear-gradient(135deg, #1a1418 0%, #2d1a28 50%, #1f1423 100%);
            --surface: linear-gradient(135deg, #2d1a28 0%, #4a2a45 100%);
            --surface-elevated: linear-gradient(135deg, #3d2538 0%, #5a3555 100%);
            --text: #fce7f3;
            --text-secondary: #fbcfe8;
            --border: #831843;
            --hover: rgba(249, 168, 212, 0.15);
            --accent: #c084fc;
        }

        body.light.pastel {
            --primary: #ec4899;
            --primary-light: #f472b6;
            --primary-dark: #db2777;
            --background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 50%, #fbcfe8 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fef3f8 100%);
            --surface-elevated: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            --text: #831843;
            --text-secondary: #9d174d;
            --border: #fbcfe8;
            --hover: rgba(236, 72, 153, 0.1);
            --accent: #a855f7;
        }

        /* Arctic Ice */
        body.dark.arctic {
            --primary: #60a5fa;
            --primary-light: #93c5fd;
            --primary-dark: #3b82f6;
            --background: linear-gradient(135deg, #0f1419 0%, #1a2530 50%, #0f1f2e 100%);
            --surface: linear-gradient(135deg, #1a2a3a 0%, #2a4555 100%);
            --surface-elevated: linear-gradient(135deg, #253545 0%, #355565 100%);
            --text: #dbeafe;
            --text-secondary: #93c5fd;
            --border: #1e3a8a;
            --hover: rgba(147, 197, 253, 0.15);
            --accent: #22d3ee;
        }

        body.light.arctic {
            --primary: #3b82f6;
            --primary-light: #60a5fa;
            --primary-dark: #2563eb;
            --background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 50%, #bfdbfe 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%);
            --surface-elevated: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            --text: #1e3a8a;
            --text-secondary: #1e40af;
            --border: #bfdbfe;
            --hover: rgba(59, 130, 246, 0.1);
            --accent: #06b6d4;
        }

        /* Cherry Blossom */
        body.dark.cherry {
            --primary: #fb7185;
            --primary-light: #fda4af;
            --primary-dark: #f43f5e;
            --background: linear-gradient(135deg, #1a0f14 0%, #2d1a23 50%, #1f1418 100%);
            --surface: linear-gradient(135deg, #2d1a23 0%, #4a2a38 100%);
            --surface-elevated: linear-gradient(135deg, #3d2530 0%, #5a3548 100%);
            --text: #ffe4e6;
            --text-secondary: #fecdd3;
            --border: #881337;
            --hover: rgba(253, 164, 175, 0.15);
            --accent: #f472b6;
        }

        body.light.cherry {
            --primary: #f43f5e;
            --primary-light: #fb7185;
            --primary-dark: #e11d48;
            --background: linear-gradient(135deg, #fff1f2 0%, #ffe4e6 50%, #fecdd3 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fff5f7 100%);
            --surface-elevated: linear-gradient(135deg, #ffe4e6 0%, #fecdd3 100%);
            --text: #881337;
            --text-secondary: #9f1239;
            --border: #fecdd3;
            --hover: rgba(244, 63, 94, 0.1);
            --accent: #ec4899;
        }

        /* Desert Sand */
        body.dark.desert {
            --primary: #f59e0b;
            --primary-light: #fbbf24;
            --primary-dark: #d97706;
            --background: linear-gradient(135deg, #1a1410 0%, #2d241a 50%, #1f1a0f 100%);
            --surface: linear-gradient(135deg, #2d241a 0%, #4a3a2a 100%);
            --surface-elevated: linear-gradient(135deg, #3d3025 0%, #5a4a35 100%);
            --text: #fef3c7;
            --text-secondary: #fcd34d;
            --border: #78350f;
            --hover: rgba(251, 191, 36, 0.15);
            --accent: #fb923c;
        }

        body.light.desert {
            --primary: #f59e0b;
            --primary-light: #fbbf24;
            --primary-dark: #d97706;
            --background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 50%, #fde68a 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fffef5 100%);
            --surface-elevated: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            --text: #78350f;
            --text-secondary: #92400e;
            --border: #fde68a;
            --hover: rgba(245, 158, 11, 0.1);
            --accent: #f97316;
        }

        /* Royal Purple */
        body.dark.royal {
            --primary: #9333ea;
            --primary-light: #a855f7;
            --primary-dark: #7e22ce;
            --background: linear-gradient(135deg, #14091a 0%, #240f2d 50%, #1a0a23 100%);
            --surface: linear-gradient(135deg, #24122d 0%, #3a1f4a 100%);
            --surface-elevated: linear-gradient(135deg, #34183d 0%, #4a2555 100%);
            --text: #f3e8ff;
            --text-secondary: #d8b4fe;
            --border: #581c87;
            --hover: rgba(168, 85, 247, 0.15);
            --accent: #f472b6;
        }

        body.light.royal {
            --primary: #7e22ce;
            --primary-light: #9333ea;
            --primary-dark: #6b21a8;
            --background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 50%, #e9d5ff 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fdf4ff 100%);
            --surface-elevated: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);
            --text: #581c87;
            --text-secondary: #6b21a8;
            --border: #e9d5ff;
            --hover: rgba(126, 34, 206, 0.1);
            --accent: #ec4899;
        }

        /* Emerald Green */
        body.dark.emerald {
            --primary: #10b981;
            --primary-light: #34d399;
            --primary-dark: #059669;
            --background: linear-gradient(135deg, #0a1a14 0%, #0f2d1f 50%, #0a231a 100%);
            --surface: linear-gradient(135deg, #0f2d1f 0%, #1a4a30 100%);
            --surface-elevated: linear-gradient(135deg, #1a3d28 0%, #256540 100%);
            --text: #d1fae5;
            --text-secondary: #6ee7b7;
            --border: #064e3b;
            --hover: rgba(52, 211, 153, 0.15);
            --accent: #fbbf24;
        }

        body.light.emerald {
            --primary: #059669;
            --primary-light: #10b981;
            --primary-dark: #047857;
            --background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 50%, #a7f3d0 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #f0fdf9 100%);
            --surface-elevated: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            --text: #064e3b;
            --text-secondary: #065f46;
            --border: #a7f3d0;
            --hover: rgba(5, 150, 105, 0.1);
            --accent: #f59e0b;
        }

        /* Golden Hour */
        body.dark.golden {
            --primary: #fb923c;
            --primary-light: #fdba74;
            --primary-dark: #f97316;
            --background: linear-gradient(135deg, #1a1210 0%, #2d1e14 50%, #1f180f 100%);
            --surface: linear-gradient(135deg, #2d1e14 0%, #4a3428 100%);
            --surface-elevated: linear-gradient(135deg, #3d2a1a 0%, #5a4030 100%);
            --text: #fed7aa;
            --text-secondary: #fdba74;
            --border: #7c2d12;
            --hover: rgba(253, 186, 116, 0.15);
            --accent: #fbbf24;
        }

        body.light.golden {
            --primary: #f97316;
            --primary-light: #fb923c;
            --primary-dark: #ea580c;
            --background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 50%, #fed7aa 100%);
            --surface: linear-gradient(135deg, #ffffff 0%, #fffaf5 100%);
            --surface-elevated: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%);
            --text: #7c2d12;
            --text-secondary: #9a3412;
            --border: #fed7aa;
            --hover: rgba(249, 115, 22, 0.1);
            --accent: #f59e0b;
        }

        body {
            background: var(--background);
            background-attachment: fixed;
            color: var(--text);
        }

        .container {
            display: grid;
            grid-template-columns: 280px 1fr;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            background: var(--surface);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        .logo {
            padding: 32px 24px;
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.5px;
        }

        .nav-section {
            padding: 0 16px;
            margin-bottom: 32px;
        }

        .nav-title {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 12px;
            letter-spacing: 1px;
            padding: 0 12px;
        }

        .nav-item {
            padding: 14px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--hover);
            transform: translateX(4px);
        }

        .nav-item.active {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .nav-item .icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .playlist-item {
            padding: 12px 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            font-size: 14px;
        }

        .playlist-item:hover {
            background: var(--hover);
        }

        .playlist-item.active {
            background: var(--surface-elevated);
            border-left: 3px solid var(--primary);
        }

        .playlist-item .delete-btn {
            opacity: 0;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 20px;
            padding: 4px 8px;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .playlist-item:hover .delete-btn {
            opacity: 1;
        }

        .playlist-item .delete-btn:hover {
            background: var(--accent);
            color: white;
        }

        .create-playlist-btn {
            margin: 16px;
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .create-playlist-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        /* Main Content */
        .main {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            padding: 24px 40px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 14px 20px 14px 48px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text);
            font-size: 15px;
            font-family: 'Outfit', sans-serif;
            transition: all 0.2s;
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        .search-bar::before {
            content: 'üîç';
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .mode-toggle {
            padding: 12px 16px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 48px;
        }

        .mode-toggle:hover {
            border-color: var(--primary);
            transform: scale(1.05);
        }

        .theme-selector {
            padding: 12px 18px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-family: 'Outfit', sans-serif;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 150px;
        }

        .theme-selector:hover {
            border-color: var(--primary);
        }

        .add-song-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .add-song-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .content {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .content.with-video {
            grid-template-columns: 1fr 400px;
        }

        .content::-webkit-scrollbar {
            width: 10px;
        }

        .content::-webkit-scrollbar-track {
            background: transparent;
        }

        .content::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        .content-main {
            min-width: 0;
        }

        .video-panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            display: none;
            flex-direction: column;
            gap: 16px;
        }

        .video-panel.active {
            display: flex;
        }

        .video-container {
            position: relative;
            width: 100%;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
        }

        .video-container video {
            width: 100%;
            height: auto;
            display: block;
        }

        .video-container iframe {
            width: 100%;
            min-height: 400px;
            border: none;
            border-radius: 8px;
        }

        .fullscreen-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
        }

        .fullscreen-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .content-header {
            margin-bottom: 32px;
        }

        .content-header h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -1px;
        }

        .content-header p {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .songs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .song-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .song-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .song-card:hover::before {
            transform: scaleX(1);
        }

        .song-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
            border-color: var(--primary);
        }

        .song-card.playing {
            border-color: var(--primary);
            background: var(--surface-elevated);
        }

        .song-card.playing::before {
            transform: scaleX(1);
        }

        .song-info h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .song-info p {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .song-type {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: var(--surface-elevated);
            color: var(--text-secondary);
        }

        .song-type.local {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
        }

        .song-type.youtube {
            background: linear-gradient(135deg, #ff0000, #ff4444);
            color: white;
        }

        .song-type.embed {
            background: linear-gradient(135deg, #06b6d4, #0ea5e9);
            color: white;
        }

        .song-actions {
            margin-top: 16px;
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .song-card:hover .song-actions {
            opacity: 1;
        }

        .song-actions button {
            flex: 1;
            padding: 8px 12px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .song-actions button:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-state h3 {
            font-size: 32px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .empty-state p {
            color: var(--text-secondary);
            font-size: 16px;
            margin-bottom: 24px;
        }

        .btn-primary {
            padding: 14px 32px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.2s;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.25);
        }

        /* Player Bar */
        .player-bar {
            background: var(--surface);
            border-top: 1px solid var(--border);
            padding: 20px 40px;
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 24px;
            align-items: center;
        }

        .now-playing {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .now-playing-info h4 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .now-playing-info p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .player-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            min-width: 400px;
        }

        .control-buttons {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .control-btn {
            background: none;
            border: none;
            color: var(--text);
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        .control-btn:hover {
            background: var(--hover);
            transform: scale(1.1);
        }

        .control-btn.play-pause {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            font-size: 20px;
        }

        .control-btn.play-pause:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .control-btn.active {
            color: var(--primary);
        }

        .progress-container {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .time {
            font-size: 12px;
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
            min-width: 40px;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: var(--surface-elevated);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 3px;
            width: 0%;
            transition: width 0.1s;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .volume-btn {
            background: none;
            border: none;
            color: var(--text);
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
        }

        .volume-slider {
            width: 100px;
            height: 6px;
            background: var(--surface-elevated);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }

        .volume-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 3px;
            width: 80%;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s;
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 24px 64px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-content h2 {
            font-size: 28px;
            margin-bottom: 24px;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
            color: var(--text);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-family: 'Outfit', sans-serif;
            font-size: 15px;
            transition: all 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }

        .modal-actions button {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal-actions .btn-cancel {
            background: var(--surface-elevated);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .modal-actions .btn-cancel:hover {
            background: var(--hover);
        }

        .modal-actions .btn-submit {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .modal-actions .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .playlist-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .playlist-option {
            padding: 16px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .playlist-option:hover {
            border-color: var(--primary);
            background: var(--hover);
        }

        .info-box {
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 20px;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .info-box strong {
            color: var(--text);
            display: block;
            margin-bottom: 8px;
        }

        .search-results {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .search-result-item {
            padding: 16px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .search-result-item:hover {
            border-color: var(--primary);
            background: var(--hover);
        }

        .search-result-thumb {
            width: 120px;
            height: 68px;
            border-radius: 8px;
            object-fit: cover;
        }

        .search-result-info {
            flex: 1;
        }

        .search-result-info h4 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .search-result-info p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        #embedPlayer {
            width: 100%;
            height: 400px;
            border: none;
            border-radius: 8px;
            display: none;
        }

        #embedPlayer.active {
            display: block;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
        }

        /* Settings Modal Styles */
        .settings-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
            border-bottom: 2px solid var(--border);
        }

        .settings-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            margin-bottom: -2px;
        }

        .settings-tab:hover {
            color: var(--text);
            background: var(--hover);
        }

        .settings-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .settings-content {
            animation: fadeIn 0.3s;
        }

        .setting-group {
            margin-bottom: 32px;
        }

        .setting-group h3 {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: var(--surface-elevated);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 12px;
            gap: 20px;
        }

        .setting-info {
            flex: 1;
        }

        .setting-info label {
            font-size: 15px;
            font-weight: 600;
            color: var(--text);
            display: block;
            margin-bottom: 4px;
        }

        .setting-info p {
            font-size: 13px;
            color: var(--text-secondary);
            margin: 0;
        }

        .setting-select {
            padding: 10px 16px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text);
            font-family: 'Outfit', sans-serif;
            font-size: 14px;
            cursor: pointer;
            min-width: 180px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border);
            border-radius: 34px;
            transition: 0.3s;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            border-radius: 50%;
            transition: 0.3s;
        }

        .toggle-switch input:checked + .toggle-slider {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        .btn-danger {
            padding: 10px 20px;
            background: linear-gradient(135deg, #dc2626, #ef4444);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
        }

        .feature-item {
            padding: 12px;
            background: var(--surface-elevated);
            border-radius: 8px;
            font-size: 14px;
        }

        .changelog {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .changelog-entry {
            padding: 16px;
            background: var(--surface-elevated);
            border-left: 4px solid var(--primary);
            border-radius: 8px;
        }

        .changelog-entry strong {
            display: block;
            margin-bottom: 8px;
            color: var(--primary);
            font-size: 15px;
        }

        .changelog-entry ul {
            margin: 8px 0 0 20px;
            color: var(--text-secondary);
        }

        .changelog-entry li {
            margin-bottom: 4px;
            font-size: 14px;
        }

        .shortcut-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            background: var(--surface-elevated);
            border-radius: 8px;
            font-size: 14px;
        }

        .shortcut-item kbd {
            padding: 4px 8px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            font-weight: 600;
            min-width: 32px;
            text-align: center;
        }
    </style>
</head>
<body class="dark purple">
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">‚ô´ Musica</div>
            
            <div class="nav-section">
                <div class="nav-title">Library</div>
                <div class="nav-item active" onclick="navigateTo('all-songs')">
                    <span class="icon">üéµ</span>
                    <span>All Songs</span>
                </div>
                <div class="nav-item" onclick="navigateTo('favorites')">
                    <span class="icon">‚ù§Ô∏è</span>
                    <span>Favorites</span>
                </div>
                <div class="nav-item" onclick="navigateTo('recent')">
                    <span class="icon">üïê</span>
                    <span>Recently Played</span>
                </div>
                <div class="nav-item" onclick="navigateTo('most-played')">
                    <span class="icon">üî•</span>
                    <span>Most Played</span>
                </div>
                <div class="nav-item" onclick="navigateTo('recommendations')">
                    <span class="icon">üéØ</span>
                    <span>Recommendations</span>
                </div>
                <div class="nav-item" onclick="navigateTo('queue')">
                    <span class="icon">üìã</span>
                    <span>Queue</span>
                </div>
                <div class="nav-item" onclick="navigateTo('stats')">
                    <span class="icon">üìä</span>
                    <span>Stats</span>
                </div>
                <div class="nav-item" onclick="navigateTo('history')">
                    <span class="icon">‚è±Ô∏è</span>
                    <span>Play History</span>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Playlists</div>
                <div id="playlistsList"></div>
                <button class="create-playlist-btn" onclick="openCreatePlaylistModal()">+ Create Playlist</button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main">
            <div class="header">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Search songs or artists..." oninput="handleSearch()">
                </div>
                <div class="header-actions">
                    <div class="mode-toggle" onclick="toggleMode()" id="modeToggle">üåí</div>
                    <select class="theme-selector" id="themeSelector" onchange="changeTheme()">
                        <optgroup label="Standard">
                            <option value="purple">Purple</option>
                            <option value="blue">Blue</option>
                            <option value="green">Green</option>
                            <option value="red">Red</option>
                            <option value="orange">Orange</option>
                            <option value="pink">Pink</option>
                        </optgroup>
                        <optgroup label="Nature & Time">
                            <option value="midnight">Midnight Sky</option>
                            <option value="sunrise">Sunrise</option>
                            <option value="dawn">Dawn</option>
                            <option value="sunset">Sunset</option>
                            <option value="afternoon">Afternoon</option>
                            <option value="ocean">Ocean Wave</option>
                            <option value="forest">Forest Green</option>
                            <option value="desert">Desert Sand</option>
                            <option value="arctic">Arctic Ice</option>
                            <option value="golden">Golden Hour</option>
                        </optgroup>
                        <optgroup label="Holidays">
                            <option value="christmas">Christmas</option>
                            <option value="halloween">Halloween</option>
                            <option value="valentine">Valentine's Day</option>
                            <option value="stpatricks">St. Patrick's Day</option>
                            <option value="easter">Easter</option>
                            <option value="july4">4th of July</option>
                        </optgroup>
                        <optgroup label="Special">
                            <option value="neon">Neon Cyberpunk</option>
                            <option value="pastel">Pastel Dream</option>
                            <option value="cherry">Cherry Blossom</option>
                            <option value="royal">Royal Purple</option>
                            <option value="emerald">Emerald Green</option>
                        </optgroup>
                    </select>
                    <button class="mode-toggle" onclick="openSettingsModal()" title="Settings">‚öôÔ∏è</button>
                    <button class="add-song-btn" onclick="openAddSongModal()">
                        <span>+</span>
                        <span>Add Song</span>
                    </button>
                </div>
            </div>

            <div class="content" id="mainContent">
                <div class="content-main" id="contentMain">
                    <!-- Content will be rendered here -->
                </div>
                <div class="video-panel" id="videoPanel">
                    <h3>Now Playing</h3>
                    <div class="video-container">
                        <video id="videoPlayer" controls></video>
                        <iframe id="embedPlayer" allow="autoplay"></iframe>
                    </div>
                    <button class="fullscreen-btn" onclick="toggleFullscreen()">‚õ∂ Fullscreen</button>
                </div>
            </div>

            <!-- Player Bar -->
            <div class="player-bar">
                <div class="now-playing">
                    <div class="now-playing-info" id="nowPlayingInfo">
                        <h4>No song playing</h4>
                        <p>Select a song to start</p>
                    </div>
                    <div style="display: flex; gap: 8px; margin-top: 8px;">
                        <button id="favoriteBtn" onclick="toggleFavorite()" style="padding: 6px 12px; background: var(--surface-elevated); border: 1px solid var(--border); border-radius: 6px; font-size: 12px; cursor: pointer; transition: all 0.2s; color: var(--text);">‚ù§Ô∏è Favorite</button>
                    </div>
                </div>

                <div class="player-controls">
                    <div class="control-buttons">
                        <button class="control-btn" id="shuffleBtn" onclick="toggleShuffle()">üîÄ</button>
                        <button class="control-btn" onclick="previousSong()">‚èÆÔ∏è</button>
                        <button class="control-btn play-pause" id="playPauseBtn" onclick="togglePlayPause()">‚ñ∂Ô∏è</button>
                        <button class="control-btn" onclick="nextSong()">‚è≠Ô∏è</button>
                        <button class="control-btn" id="loopBtn" onclick="toggleLoop()">üîÅ</button>
                    </div>
                    <div class="progress-container">
                        <span class="time" id="currentTime">0:00</span>
                        <div class="progress-bar" id="progressBar" onclick="seekTo(event)">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <span class="time" id="totalTime">0:00</span>
                    </div>
                </div>

                <div class="volume-control">
                    <button class="volume-btn" onclick="toggleMute()" id="volumeBtn">üîä</button>
                    <div class="volume-slider" onclick="setVolume(event)">
                        <div class="volume-fill" id="volumeFill"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Song Modal -->
    <div class="modal" id="addSongModal">
        <div class="modal-content">
            <h2>Add New Song</h2>
            
            <div class="form-group">
                <label>Song Type</label>
                <select id="songType" onchange="updateAddSongForm()">
                    <option value="local">Local File (MP3/MP4)</option>
                    <option value="youtube-search">YouTube (URL or Search)</option>
                    <option value="embed">Custom Embed (Any Platform)</option>
                </select>
            </div>

            <div id="localFileForm">
                <div class="form-group">
                    <label>Select File</label>
                    <input type="file" id="fileInput" accept="audio/*,video/mp4">
                </div>
                
                <div class="form-group">
                    <label>Song Name</label>
                    <input type="text" id="songName" placeholder="Enter song name">
                </div>
                
                <div class="form-group">
                    <label>Artist</label>
                    <input type="text" id="artistName" placeholder="Enter artist name">
                </div>

                <div class="form-group">
                    <label>Album Art (Optional)</label>
                    <input type="file" id="albumArtInput" accept="image/*">
                    <p style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Upload a cover image for this song</p>
                </div>
            </div>

            <div id="youtubeSearchForm" style="display: none;">
                <div class="info-box">
                    <strong>Two ways to add YouTube music:</strong>
                    <strong style="color: var(--primary); margin-top: 8px;">Option 1: Paste YouTube URL</strong>
                    Copy the video URL from YouTube (e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ)
                    
                    <strong style="color: var(--primary); margin-top: 8px;">Option 2: Search on YouTube</strong>
                    Type a song name or artist, and you'll get a YouTube search link to find your video
                </div>
                
                <div class="form-group">
                    <label>YouTube URL or Search Query</label>
                    <input type="text" id="youtubeInput" placeholder="Paste URL or type to search..." oninput="handleYouTubeInput()">
                </div>
                
                <div id="youtubePreview" style="display: none; margin-top: 16px;">
                    <div class="info-box" style="background: linear-gradient(135deg, var(--primary), var(--primary-light)); color: white; border: none;">
                        <strong id="youtubePreviewTitle">‚úì Ready to add!</strong>
                        <p id="youtubePreviewMessage" style="color: white; margin-top: 8px;"></p>
                    </div>
                </div>
                
                <div id="youtubeSearchLink" style="display: none; margin-top: 16px;">
                    <div class="info-box" style="background: var(--surface-elevated); border: 2px solid var(--primary);">
                        <strong>üîç Search YouTube</strong>
                        <p style="margin-top: 8px;">Click below to search YouTube, then copy the URL of the video you want:</p>
                        <a id="youtubeSearchButton" href="#" target="_blank" style="display: inline-block; margin-top: 12px; padding: 10px 20px; background: linear-gradient(135deg, #ff0000, #cc0000); color: white; text-decoration: none; border-radius: 8px; font-weight: 600;">
                            üéµ Search on YouTube
                        </a>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Song Name</label>
                    <input type="text" id="youtubeSongName" placeholder="Enter song name">
                </div>
                
                <div class="form-group">
                    <label>Artist</label>
                    <input type="text" id="youtubeArtistName" placeholder="Enter artist name">
                </div>
            </div>

            <div id="embedForm" style="display: none;">
                <div class="info-box">
                    <strong>‚úÖ Works with ANY platform!</strong><br>
                    <strong style="color: var(--primary); margin-top: 8px; display: block;">Examples:</strong>
                    ‚Ä¢ SoundCloud, Spotify, Bandcamp<br>
                    ‚Ä¢ Vimeo, Dailymotion<br>
                    ‚Ä¢ Any site with embed/iframe codes<br><br>
                    <strong style="color: var(--primary);">How to add:</strong><br>
                    1. Go to the platform and find your song/video<br>
                    2. Click "Share" ‚Üí "Embed" or similar<br>
                    3. Copy the entire &lt;iframe&gt; code<br>
                    4. Paste it below and click "Add Song"<br><br>
                    <strong style="color: var(--accent);">üí° Tip:</strong> You can also just paste the direct URL!
                </div>
                
                <div class="form-group">
                    <label>Embed Code or URL</label>
                    <textarea id="embedCode" rows="4" placeholder='Paste iframe code or direct URL here...

Example iframe:
<iframe src="https://..." ...></iframe>

Or just paste URL:
https://example.com/embed/...'></textarea>
                </div>
                
                <div class="form-group">
                    <label>Song Name</label>
                    <input type="text" id="embedSongName" placeholder="Enter song name">
                </div>
                
                <div class="form-group">
                    <label>Artist</label>
                    <input type="text" id="embedArtistName" placeholder="Enter artist name">
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeAddSongModal()">Cancel</button>
                <button class="btn-submit" id="addSongBtn" onclick="addSong()">Add Song</button>
            </div>
        </div>
    </div>

    <!-- Create Playlist Modal -->
    <div class="modal" id="createPlaylistModal">
        <div class="modal-content">
            <h2>Create Playlist</h2>
            
            <div class="form-group">
                <label>Playlist Name</label>
                <input type="text" id="playlistNameInput" placeholder="My Awesome Playlist">
            </div>

            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeCreatePlaylistModal()">Cancel</button>
                <button class="btn-submit" onclick="createPlaylist()">Create</button>
            </div>
        </div>
    </div>

    <!-- Add to Playlist Modal -->
    <div class="modal" id="addToPlaylistModal">
        <div class="modal-content">
            <h2>Add to Playlist</h2>
            
            <div class="playlist-list" id="playlistOptions">
                <!-- Playlist options will be rendered here -->
            </div>

            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeAddToPlaylistModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content" style="max-width: 700px;">
            <h2>‚öôÔ∏è Settings</h2>
            
            <div class="settings-tabs">
                <button class="settings-tab active" onclick="switchSettingsTab('general')">General</button>
                <button class="settings-tab" onclick="switchSettingsTab('playback')">Playback</button>
                <button class="settings-tab" onclick="switchSettingsTab('about')">About</button>
            </div>

            <!-- General Tab -->
            <div class="settings-content" id="generalSettings">
                <div class="setting-group">
                    <h3>Appearance</h3>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Dark Mode</label>
                            <p>Toggle between dark and light themes</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeToggle" onchange="toggleModeFromSettings()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Color Theme</label>
                            <p>Choose your preferred color scheme</p>
                        </div>
                        <select class="setting-select" id="themeSelectSettings" onchange="changeThemeFromSettings()">
                            <optgroup label="Standard">
                                <option value="purple">Purple</option>
                                <option value="blue">Blue</option>
                                <option value="green">Green</option>
                                <option value="red">Red</option>
                                <option value="orange">Orange</option>
                                <option value="pink">Pink</option>
                            </optgroup>
                            <optgroup label="Nature & Time">
                                <option value="midnight">Midnight Sky</option>
                                <option value="sunrise">Sunrise</option>
                                <option value="dawn">Dawn</option>
                                <option value="sunset">Sunset</option>
                                <option value="afternoon">Afternoon</option>
                                <option value="ocean">Ocean Wave</option>
                                <option value="forest">Forest Green</option>
                                <option value="desert">Desert Sand</option>
                                <option value="arctic">Arctic Ice</option>
                                <option value="golden">Golden Hour</option>
                            </optgroup>
                            <optgroup label="Holidays">
                                <option value="christmas">Christmas</option>
                                <option value="halloween">Halloween</option>
                                <option value="valentine">Valentine's Day</option>
                                <option value="stpatricks">St. Patrick's Day</option>
                                <option value="easter">Easter</option>
                                <option value="july4">4th of July</option>
                            </optgroup>
                            <optgroup label="Special">
                                <option value="neon">Neon Cyberpunk</option>
                                <option value="pastel">Pastel Dream</option>
                                <option value="cherry">Cherry Blossom</option>
                                <option value="royal">Royal Purple</option>
                                <option value="emerald">Emerald Green</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Storage</h3>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Clear All Data</label>
                            <p>Remove all songs, playlists, and settings</p>
                        </div>
                        <button class="btn-danger" onclick="clearAllData()">Clear Data</button>
                    </div>
                </div>
            </div>

            <!-- Playback Tab -->
            <div class="settings-content" id="playbackSettings" style="display: none;">
                <div class="setting-group">
                    <h3>Playback Options</h3>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Autoplay</label>
                            <p>Automatically play next song when current song ends</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoplayToggle" onchange="toggleAutoplay()" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Volume Boost</label>
                            <p>Amplify quiet songs for consistent volume</p>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="volumeBoostToggle" onchange="toggleVolumeBoost()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Default Volume</label>
                            <p>Set the initial volume level (0-100%)</p>
                        </div>
                        <div style="display: flex; align-items: center; gap: 12px; min-width: 200px;">
                            <input type="range" min="0" max="100" value="80" id="defaultVolumeSlider" 
                                   oninput="updateDefaultVolume()" style="flex: 1;">
                            <span id="volumePercentage" style="min-width: 45px; font-weight: 600;">80%</span>
                        </div>
                    </div>

                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Crossfade Duration</label>
                            <p>Smooth transition between songs (seconds)</p>
                        </div>
                        <select class="setting-select" id="crossfadeSelect" onchange="updateCrossfade()">
                            <option value="0">Off</option>
                            <option value="2">2 seconds</option>
                            <option value="4">4 seconds</option>
                            <option value="6">6 seconds</option>
                            <option value="8">8 seconds</option>
                        </select>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Quality</h3>
                    
                    <div class="setting-item">
                        <div class="setting-info">
                            <label>Streaming Quality</label>
                            <p>Higher quality uses more bandwidth</p>
                        </div>
                        <select class="setting-select" id="qualitySelect" onchange="updateQuality()">
                            <option value="low">Low (96 kbps)</option>
                            <option value="normal" selected>Normal (128 kbps)</option>
                            <option value="high">High (256 kbps)</option>
                            <option value="very-high">Very High (320 kbps)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- About Tab -->
            <div class="settings-content" id="aboutSettings" style="display: none;">
                <div class="setting-group">
                    <h3>About Musica</h3>
                    <div class="info-box">
                        <strong style="font-size: 18px; margin-bottom: 16px;">üéµ Musica Player</strong>
                        <p style="margin-bottom: 8px;"><strong>Version:</strong> 2.0.0</p>
                        <p style="margin-bottom: 16px;"><strong>Release Date:</strong> February 2026</p>
                        <p>A beautiful, feature-rich music player with support for local files, YouTube integration, and custom embeds.</p>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Features</h3>
                    <div style="display: grid; gap: 8px;">
                        <div class="feature-item">‚úÖ Local MP3/MP4 file playback</div>
                        <div class="feature-item">‚úÖ YouTube search and integration</div>
                        <div class="feature-item">‚úÖ Universal embed support</div>
                        <div class="feature-item">‚úÖ Video playback with fullscreen</div>
                        <div class="feature-item">‚úÖ Custom playlists</div>
                        <div class="feature-item">‚úÖ 24 color themes (12 themes √ó light/dark)</div>
                        <div class="feature-item">‚úÖ Shuffle and repeat modes</div>
                        <div class="feature-item">‚úÖ Queue management</div>
                        <div class="feature-item">‚úÖ Search functionality</div>
                        <div class="feature-item">‚úÖ Persistent storage (IndexedDB)</div>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Changelog</h3>
                    <div class="changelog">
                        <div class="changelog-entry">
                            <strong>Version 2.0.0</strong> - February 10, 2026
                            <ul>
                                <li>Added gradient backgrounds to nature and holiday themes</li>
                                <li>Implemented comprehensive settings panel</li>
                                <li>Added autoplay toggle feature</li>
                                <li>Added default volume control</li>
                                <li>Added crossfade settings</li>
                                <li>Added streaming quality options</li>
                                <li>Improved theme switching performance</li>
                                <li>Enhanced UI/UX across all components</li>
                            </ul>
                        </div>
                        <div class="changelog-entry">
                            <strong>Version 1.5.0</strong> - February 9, 2026
                            <ul>
                                <li>Added YouTube search functionality</li>
                                <li>Added video playback support</li>
                                <li>Added fullscreen mode for videos</li>
                                <li>Added universal embed support</li>
                                <li>Added 12 new themes</li>
                                <li>Added dark/light mode toggle</li>
                            </ul>
                        </div>
                        <div class="changelog-entry">
                            <strong>Version 1.0.0</strong> - February 8, 2026
                            <ul>
                                <li>Initial release</li>
                                <li>Local file playback</li>
                                <li>Basic playlist management</li>
                                <li>IndexedDB storage implementation</li>
                                <li>Core playback controls</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>Keyboard Shortcuts</h3>
                    <div style="display: grid; gap: 8px;">
                        <div class="shortcut-item"><kbd>Space</kbd> Play / Pause</div>
                        <div class="shortcut-item"><kbd>‚Üí</kbd> Next track</div>
                        <div class="shortcut-item"><kbd>‚Üê</kbd> Previous track</div>
                        <div class="shortcut-item"><kbd>‚Üë</kbd> Volume up</div>
                        <div class="shortcut-item"><kbd>‚Üì</kbd> Volume down</div>
                        <div class="shortcut-item"><kbd>M</kbd> Mute / Unmute</div>
                        <div class="shortcut-item"><kbd>S</kbd> Toggle shuffle</div>
                        <div class="shortcut-item"><kbd>R</kbd> Toggle repeat</div>
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn-submit" onclick="closeSettingsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Hidden audio and embed players -->
    <!-- Lyrics Modal -->
    <div class="modal" id="lyricsModal">
        <div class="modal-content">
            <h2>üé§ Song Lyrics</h2>
            <div id="lyricsInfo" style="margin-bottom: 16px;"></div>
            
            <div class="form-group">
                <label>Lyrics</label>
                <textarea id="lyricsTextarea" rows="15" placeholder="Paste or type lyrics here..." style="resize: vertical;"></textarea>
            </div>

            <div class="modal-actions">
                <button class="btn-cancel" onclick="closeLyricsModal()">Cancel</button>
                <button class="btn-submit" onclick="saveLyrics()">Save Lyrics</button>
            </div>
        </div>
    </div>

    <audio id="audioPlayer" onended="handleSongEnd()" ontimeupdate="updateProgress()"></audio>

    <script>
        // State
        let songs = [];
        let playlists = [];
        let currentView = 'all-songs';
        let currentPlaylist = null;
        let currentSongIndex = -1;
        let isPlaying = false;
        let shuffleMode = false;
        let loopMode = 'off';
        let queue = [];
        let searchTerm = '';
        let selectedSongForPlaylist = null;
        let volume = 0.8;
        let isMuted = false;
        let isDarkMode = true;
        let currentTheme = 'purple';
        let autoplayEnabled = true;
        let crossfadeDuration = 0;
        let streamingQuality = 'normal';
        let db;
        const DB_NAME = 'MusicPlayerDB';
        const DB_VERSION = 1;
        const STORE_NAME = 'audioFiles';

        // Initialize IndexedDB
        function initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);
                
                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    db = request.result;
                    resolve(db);
                };
                
                request.onupgradeneeded = (event) => {
                    db = event.target.result;
                    if (!db.objectStoreNames.contains(STORE_NAME)) {
                        db.createObjectStore(STORE_NAME, { keyPath: 'id' });
                    }
                };
            });
        }

        // Store audio file in IndexedDB
        function storeAudioFile(id, file) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.put({ id, file });
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // Get audio file from IndexedDB
        function getAudioFile(id) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readonly');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.get(id);
                
                request.onsuccess = () => {
                    if (request.result) {
                        resolve(request.result.file);
                    } else {
                        reject(new Error('File not found'));
                    }
                };
                request.onerror = () => reject(request.error);
            });
        }

        // Delete audio file from IndexedDB
        function deleteAudioFile(id) {
            return new Promise((resolve, reject) => {
                const transaction = db.transaction([STORE_NAME], 'readwrite');
                const store = transaction.objectStore(STORE_NAME);
                const request = store.delete(id);
                
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // NEW FEATURES STATE
        let favorites = new Set();
        let recentlyPlayed = [];
        let playCount = {};
        let smartShuffleEnabled = false;
        let volumeBoostEnabled = false;
        let albumArtCache = {};
        let songLyrics = {};
        let playHistoryTimeline = [];

        const audioPlayer = document.getElementById('audioPlayer');
        const videoPlayer = document.getElementById('videoPlayer');
        const embedPlayer = document.getElementById('embedPlayer');

        // Initialize
        async function init() {
            try {
                await initDB();
                loadFromLocalStorage();
                loadTheme();
                renderPlaylists();
                renderContent();
                audioPlayer.volume = volume;
                videoPlayer.volume = volume;
                
                // Sync video player events with audio player events
                videoPlayer.addEventListener('ended', handleSongEnd);
                videoPlayer.addEventListener('timeupdate', updateProgress);
            } catch (error) {
                console.error('Initialization error:', error);
                alert('Error initializing app. Please refresh the page.');
            }
        }

        function loadFromLocalStorage() {
            try {
                const savedSongs = localStorage.getItem('musicAppSongsMeta');
                const savedPlaylists = localStorage.getItem('musicAppPlaylists');
                const savedMode = localStorage.getItem('musicAppMode');
                const savedTheme = localStorage.getItem('musicAppTheme');
                const savedAutoplay = localStorage.getItem('musicAppAutoplay');
                const savedVolume = localStorage.getItem('musicAppVolume');
                const savedCrossfade = localStorage.getItem('musicAppCrossfade');
                const savedQuality = localStorage.getItem('musicAppQuality');
                const savedFavorites = localStorage.getItem('musicAppFavorites');
                const savedRecent = localStorage.getItem('musicAppRecent');
                const savedPlayCount = localStorage.getItem('musicAppPlayCount');
                const savedVolumeBoost = localStorage.getItem('musicAppVolumeBoost');
                const savedAlbumArt = localStorage.getItem('musicAppAlbumArt');
                const savedLyrics = localStorage.getItem('musicAppLyrics');
                const savedTimeline = localStorage.getItem('musicAppTimeline');
                
                if (savedSongs) songs = JSON.parse(savedSongs);
                if (savedPlaylists) playlists = JSON.parse(savedPlaylists);
                if (savedMode) isDarkMode = savedMode === 'dark';
                if (savedTheme) currentTheme = savedTheme;
                if (savedAutoplay !== null) autoplayEnabled = savedAutoplay === 'true';
                if (savedVolume) volume = parseFloat(savedVolume);
                if (savedCrossfade) crossfadeDuration = parseInt(savedCrossfade);
                if (savedQuality) streamingQuality = savedQuality;
                if (savedFavorites) favorites = new Set(JSON.parse(savedFavorites));
                if (savedRecent) recentlyPlayed = JSON.parse(savedRecent);
                if (savedPlayCount) playCount = JSON.parse(savedPlayCount);
                if (savedVolumeBoost) volumeBoostEnabled = savedVolumeBoost === 'true';
                if (savedAlbumArt) albumArtCache = JSON.parse(savedAlbumArt);
                if (savedLyrics) songLyrics = JSON.parse(savedLyrics);
                if (savedTimeline) playHistoryTimeline = JSON.parse(savedTimeline);
            } catch (error) {
                console.error('Error loading from localStorage:', error);
            }
        }

        function loadTheme() {
            applyTheme();
            document.getElementById('themeSelector').value = currentTheme;
        }

        function toggleMode() {
            isDarkMode = !isDarkMode;
            localStorage.setItem('musicAppMode', isDarkMode ? 'dark' : 'light');
            applyTheme();
        }

        function changeTheme() {
            currentTheme = document.getElementById('themeSelector').value;
            localStorage.setItem('musicAppTheme', currentTheme);
            applyTheme();
        }

        function applyTheme() {
            const mode = isDarkMode ? 'dark' : 'light';
            document.body.className = `${mode} ${currentTheme}`;
            document.getElementById('modeToggle').textContent = isDarkMode ? 'üåí' : 'üåî';
        }

        // Navigation
        function navigateTo(view) {
            currentView = view;
            currentPlaylist = null;
            
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.playlist-item').forEach(item => item.classList.remove('active'));
            
            event.target.closest('.nav-item').classList.add('active');
            renderContent();
        }

        // Modal Functions
        function openAddSongModal() {
            document.getElementById('addSongModal').classList.add('active');
            updateAddSongForm();
        }

        function closeAddSongModal() {
            document.getElementById('addSongModal').classList.remove('active');
            document.getElementById('fileInput').value = '';
            document.getElementById('songName').value = '';
            document.getElementById('artistName').value = '';
            document.getElementById('youtubeInput').value = '';
            document.getElementById('youtubeSongName').value = '';
            document.getElementById('youtubeArtistName').value = '';
            document.getElementById('youtubePreview').style.display = 'none';
            document.getElementById('youtubeSearchLink').style.display = 'none';
            document.getElementById('embedCode').value = '';
            document.getElementById('embedSongName').value = '';
            document.getElementById('embedArtistName').value = '';
            extractedVideoId = null;
        }

        function updateAddSongForm() {
            const type = document.getElementById('songType').value;
            document.getElementById('localFileForm').style.display = type === 'local' ? 'block' : 'none';
            document.getElementById('youtubeSearchForm').style.display = type === 'youtube-search' ? 'block' : 'none';
            document.getElementById('embedForm').style.display = type === 'embed' ? 'block' : 'none';
            
            // Show Add Song button for all types
            const addBtn = document.getElementById('addSongBtn');
            addBtn.style.display = 'block';
        }

        // YouTube URL extraction and search handling
        let extractedVideoId = null;

        function handleYouTubeInput() {
            const input = document.getElementById('youtubeInput').value.trim();
            const preview = document.getElementById('youtubePreview');
            const searchLink = document.getElementById('youtubeSearchLink');
            const previewTitle = document.getElementById('youtubePreviewTitle');
            const previewMessage = document.getElementById('youtubePreviewMessage');
            
            if (!input) {
                preview.style.display = 'none';
                searchLink.style.display = 'none';
                extractedVideoId = null;
                return;
            }
            
            // Check if it's a URL
            if (input.includes('youtube.com') || input.includes('youtu.be')) {
                // Extract video ID from various YouTube URL formats
                let videoId = null;
                
                // Standard watch URL
                const watchMatch = input.match(/[?&]v=([^&]+)/);
                if (watchMatch) videoId = watchMatch[1];
                
                // Short URL
                const shortMatch = input.match(/youtu\.be\/([^?&]+)/);
                if (shortMatch) videoId = shortMatch[1];
                
                // Embed URL
                const embedMatch = input.match(/embed\/([^?&]+)/);
                if (embedMatch) videoId = embedMatch[1];
                
                if (videoId) {
                    extractedVideoId = videoId;
                    previewTitle.textContent = '‚úì YouTube Video Detected!';
                    previewMessage.textContent = `Video ID: ${videoId}`;
                    preview.style.display = 'block';
                    searchLink.style.display = 'none';
                } else {
                    preview.style.display = 'none';
                    searchLink.style.display = 'none';
                    extractedVideoId = null;
                }
            } else {
                // It's a search query - show search link
                const searchUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(input)}`;
                document.getElementById('youtubeSearchButton').href = searchUrl;
                searchLink.style.display = 'block';
                preview.style.display = 'none';
                extractedVideoId = null;
            }
        }

        function openCreatePlaylistModal() {
            document.getElementById('createPlaylistModal').classList.add('active');
        }

        function closeCreatePlaylistModal() {
            document.getElementById('createPlaylistModal').classList.remove('active');
            document.getElementById('playlistNameInput').value = '';
        }

        function openAddToPlaylistModal(songId) {
            selectedSongForPlaylist = songId;
            const container = document.getElementById('playlistOptions');
            
            if (playlists.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>No playlists yet. Create one first!</p></div>';
            } else {
                container.innerHTML = playlists.map(playlist => `
                    <div class="playlist-option" onclick="addSongToPlaylist('${playlist.id}')">
                        <span>üìÅ ${playlist.name}</span>
                        <span style="color: var(--text-secondary)">${playlist.songs.length} songs</span>
                    </div>
                `).join('');
            }
            
            document.getElementById('addToPlaylistModal').classList.add('active');
        }

        function closeAddToPlaylistModal() {
            document.getElementById('addToPlaylistModal').classList.remove('active');
            selectedSongForPlaylist = null;
        }

        // Song Management
        async function addSong() {
            const type = document.getElementById('songType').value;
            
            try {
                if (type === 'local') {
                    const file = document.getElementById('fileInput').files[0];
                    const name = document.getElementById('songName').value.trim();
                    const artist = document.getElementById('artistName').value.trim();
                    const albumArtFile = document.getElementById('albumArtInput').files[0];
                    
                    if (!file) {
                        alert('Please select a file');
                        return;
                    }
                    
                    if (!name || !artist) {
                        alert('Please enter song name and artist');
                        return;
                    }
                    
                    const songId = Date.now().toString();
                    const isVideo = file.type.startsWith('video/');
                    
                    // Store file in IndexedDB
                    await storeAudioFile(songId, file);
                    
                    // Handle album art
                    if (albumArtFile) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            albumArtCache[songId] = e.target.result;
                            saveSongsMeta();
                        };
                        reader.readAsDataURL(albumArtFile);
                    }
                    
                    songs.push({
                        id: songId,
                        name,
                        artist,
                        type: 'local',
                        fileName: file.name,
                        isVideo: isVideo
                    });
                    
                } else if (type === 'youtube-search') {
                    const name = document.getElementById('youtubeSongName').value.trim();
                    const artist = document.getElementById('youtubeArtistName').value.trim();
                    
                    if (!extractedVideoId) {
                        alert('Please enter a valid YouTube URL');
                        return;
                    }
                    
                    if (!name || !artist) {
                        alert('Please enter song name and artist');
                        return;
                    }
                    
                    songs.push({
                        id: Date.now().toString(),
                        name,
                        artist,
                        type: 'youtube',
                        videoId: extractedVideoId
                    });
                    
                    extractedVideoId = null;
                    
                } else if (type === 'embed') {
                    const embedCode = document.getElementById('embedCode').value.trim();
                    const name = document.getElementById('embedSongName').value.trim();
                    const artist = document.getElementById('embedArtistName').value.trim();
                    
                    if (!embedCode || !name || !artist) {
                        alert('Please fill in all fields');
                        return;
                    }
                    
                    // Extract src from iframe - handle multiple formats
                    let embedSrc = null;
                    
                    // Try to extract src attribute
                    const srcMatch = embedCode.match(/src=["']([^"']+)["']/);
                    if (srcMatch) {
                        embedSrc = srcMatch[1];
                    } else if (embedCode.startsWith('http')) {
                        // Direct URL provided
                        embedSrc = embedCode;
                    }
                    
                    if (!embedSrc) {
                        alert('Could not extract embed URL. Please paste the complete iframe code or direct embed URL.');
                        return;
                    }
                    
                    // Make sure embed URL allows autoplay
                    if (!embedSrc.includes('autoplay')) {
                        embedSrc += (embedSrc.includes('?') ? '&' : '?') + 'autoplay=1';
                    }
                    
                    songs.push({
                        id: Date.now().toString(),
                        name,
                        artist,
                        type: 'embed',
                        embedSrc: embedSrc
                    });
                }
                
                saveSongsMeta();
                renderContent();
                closeAddSongModal();
                
            } catch (error) {
                console.error('Error adding song:', error);
                alert('Error adding song. Please try again.');
            }
        }

        async function deleteSong(songId) {
            if (!confirm('Are you sure you want to delete this song?')) return;
            
            try {
                const song = songs.find(s => s.id === songId);
                
                if (song.type === 'local') {
                    await deleteAudioFile(songId);
                }
                
                songs = songs.filter(s => s.id !== songId);
                
                playlists.forEach(playlist => {
                    playlist.songs = playlist.songs.filter(id => id !== songId);
                });
                
                queue = queue.filter(id => id !== songId);
                
                saveSongsMeta();
                savePlaylists();
                renderContent();
                
                if (currentSongIndex !== -1 && songs[currentSongIndex]?.id === songId) {
                    stopPlayback();
                }
            } catch (error) {
                console.error('Error deleting song:', error);
                alert('Error deleting song. Please try again.');
            }
        }

        function stopPlayback() {
            audioPlayer.pause();
            audioPlayer.src = '';
            videoPlayer.pause();
            videoPlayer.src = '';
            embedPlayer.src = '';
            embedPlayer.classList.remove('active');
            document.getElementById('videoPanel').classList.remove('active');
            document.getElementById('mainContent').classList.remove('with-video');
            currentSongIndex = -1;
            isPlaying = false;
            updatePlayPauseButton();
            updateNowPlaying();
        }

        // Playback
        async function playSong(songId) {
            const songIndex = songs.findIndex(s => s.id === songId);
            if (songIndex === -1) return;
            
            currentSongIndex = songIndex;
            const song = songs[songIndex];
            
            // Track play count and recently played
            playCount[songId] = (playCount[songId] || 0) + 1;
            recentlyPlayed = [songId, ...recentlyPlayed.filter(id => id !== songId)].slice(0, 50);
            playHistoryTimeline.push({
                songId: songId,
                timestamp: new Date().toISOString(),
                songName: song.name,
                artist: song.artist
            });
            saveSongsMeta();
            
            try {
                // Stop all players first
                audioPlayer.pause();
                audioPlayer.src = '';
                videoPlayer.pause();
                videoPlayer.src = '';
                embedPlayer.src = '';
                embedPlayer.classList.remove('active');
                document.getElementById('videoPanel').classList.remove('active');
                document.getElementById('mainContent').classList.remove('with-video');
                
                if (song.type === 'local') {
                    const file = await getAudioFile(song.id);
                    const url = URL.createObjectURL(file);
                    
                    if (song.isVideo) {
                        // Play video
                        videoPlayer.src = url;
                        await videoPlayer.play();
                        document.getElementById('videoPanel').classList.add('active');
                        document.getElementById('mainContent').classList.add('with-video');
                    } else {
                        // Play audio
                        audioPlayer.src = url;
                        await audioPlayer.play();
                    }
                    isPlaying = true;
                    
                } else if (song.type === 'youtube') {
                    // Play YouTube video in iframe
                    audioPlayer.pause();
                    audioPlayer.src = '';
                    
                    const embedSrc = `https://www.youtube.com/embed/${song.videoId}?autoplay=1&enablejsapi=1`;
                    embedPlayer.src = embedSrc;
                    embedPlayer.classList.add('active');
                    isPlaying = true;
                    
                } else if (song.type === 'embed') {
                    // Play custom embed
                    audioPlayer.pause();
                    audioPlayer.src = '';
                    videoPlayer.pause();
                    videoPlayer.src = '';
                    
                    // Ensure autoplay parameter is present
                    let embedSrc = song.embedSrc;
                    if (!embedSrc.includes('autoplay=1')) {
                        embedSrc += (embedSrc.includes('?') ? '&' : '?') + 'autoplay=1';
                    }
                    
                    embedPlayer.src = embedSrc;
                    embedPlayer.classList.add('active');
                    document.getElementById('videoPanel').classList.add('active');
                    document.getElementById('mainContent').classList.add('with-video');
                    isPlaying = true;
                }
                
                updatePlayPauseButton();
                updateNowPlaying();
                renderContent();
                
            } catch (error) {
                console.error('Error playing song:', error);
                alert('Error playing song. The file may be missing or the embed URL may be invalid.');
            }
        }

        function togglePlayPause() {
            if (currentSongIndex === -1) {
                if (songs.length > 0) {
                    playSong(songs[0].id);
                }
                return;
            }
            
            const currentSong = songs[currentSongIndex];
            
            if (currentSong.type === 'local') {
                if (currentSong.isVideo) {
                    if (isPlaying) {
                        videoPlayer.pause();
                        isPlaying = false;
                    } else {
                        videoPlayer.play();
                        isPlaying = true;
                    }
                } else {
                    if (isPlaying) {
                        audioPlayer.pause();
                        isPlaying = false;
                    } else {
                        audioPlayer.play();
                        isPlaying = true;
                    }
                }
                updatePlayPauseButton();
            } else {
                alert('Use the player controls to play/pause');
            }
        }

        function updatePlayPauseButton() {
            document.getElementById('playPauseBtn').textContent = isPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è';
        }

        function updateNowPlaying() {
            const container = document.getElementById('nowPlayingInfo');
            
            if (currentSongIndex === -1) {
                container.innerHTML = `
                    <h4>No song playing</h4>
                    <p>Select a song to start</p>
                `;
            } else {
                const song = songs[currentSongIndex];
                container.innerHTML = `
                    <h4>${song.name}</h4>
                    <p>${song.artist}</p>
                `;
                updateFavoriteButton();
            }
        }

        function nextSong() {
            if (songs.length === 0) return;
            
            if (shuffleMode) {
                currentSongIndex = Math.floor(Math.random() * songs.length);
            } else {
                currentSongIndex = (currentSongIndex + 1) % songs.length;
            }
            
            playSong(songs[currentSongIndex].id);
        }

        function previousSong() {
            if (songs.length === 0) return;
            
            if (shuffleMode) {
                currentSongIndex = Math.floor(Math.random() * songs.length);
            } else {
                currentSongIndex = currentSongIndex - 1;
                if (currentSongIndex < 0) currentSongIndex = songs.length - 1;
            }
            
            playSong(songs[currentSongIndex].id);
        }

        function handleSongEnd() {
            if (loopMode === 'one') {
                playSong(songs[currentSongIndex].id);
            } else if (loopMode === 'all') {
                nextSong();
            } else if (autoplayEnabled) {
                if (currentSongIndex < songs.length - 1) {
                    nextSong();
                } else {
                    isPlaying = false;
                    updatePlayPauseButton();
                }
            } else {
                isPlaying = false;
                updatePlayPauseButton();
            }
        }

        function toggleShuffle() {
            shuffleMode = !shuffleMode;
            document.getElementById('shuffleBtn').classList.toggle('active', shuffleMode);
        }

        function toggleLoop() {
            const modes = ['off', 'all', 'one'];
            const currentIndex = modes.indexOf(loopMode);
            loopMode = modes[(currentIndex + 1) % modes.length];
            
            const btn = document.getElementById('loopBtn');
            btn.classList.toggle('active', loopMode !== 'off');
            
            if (loopMode === 'one') {
                btn.textContent = 'üîÇ';
            } else {
                btn.textContent = 'üîÅ';
            }
        }

        function toggleFullscreen() {
            const video = document.getElementById('videoPlayer');
            if (video.requestFullscreen) {
                video.requestFullscreen();
            } else if (video.webkitRequestFullscreen) {
                video.webkitRequestFullscreen();
            } else if (video.msRequestFullscreen) {
                video.msRequestFullscreen();
            }
        }

        // Progress and Volume
        function updateProgress() {
            const player = songs[currentSongIndex]?.isVideo ? videoPlayer : audioPlayer;
            
            if (player.duration) {
                const progress = (player.currentTime / player.duration) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('currentTime').textContent = formatTime(player.currentTime);
                document.getElementById('totalTime').textContent = formatTime(player.duration);
            }
        }

        function seekTo(event) {
            if (currentSongIndex === -1) return;
            const song = songs[currentSongIndex];
            if (song.type !== 'local') return;
            
            const progressBar = document.getElementById('progressBar');
            const rect = progressBar.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const percentage = x / rect.width;
            
            const player = song.isVideo ? videoPlayer : audioPlayer;
            player.currentTime = percentage * player.duration;
        }

        function setVolume(event) {
            const slider = event.currentTarget;
            const rect = slider.getBoundingClientRect();
            const x = event.clientX - rect.left;
            volume = x / rect.width;
            
            audioPlayer.volume = volume;
            videoPlayer.volume = volume;
            document.getElementById('volumeFill').style.width = (volume * 100) + '%';
            isMuted = false;
        }

        function toggleMute() {
            isMuted = !isMuted;
            audioPlayer.muted = isMuted;
            videoPlayer.muted = isMuted;
            
            const btn = document.getElementById('volumeBtn');
            btn.textContent = isMuted ? 'üîá' : 'üîä';
        }

        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        // Playlist Management
        function createPlaylist() {
            const name = document.getElementById('playlistNameInput').value.trim();
            if (!name) {
                alert('Please enter a playlist name');
                return;
            }
            
            playlists.push({
                id: Date.now().toString(),
                name,
                songs: []
            });
            
            savePlaylists();
            renderPlaylists();
            closeCreatePlaylistModal();
        }

        function deletePlaylist(playlistId) {
            if (!confirm('Are you sure you want to delete this playlist?')) return;
            
            playlists = playlists.filter(p => p.id !== playlistId);
            savePlaylists();
            renderPlaylists();
            
            if (currentPlaylist === playlistId) {
                currentView = 'all-songs';
                currentPlaylist = null;
                renderContent();
            }
        }

        function viewPlaylist(playlistId) {
            currentPlaylist = playlistId;
            currentView = 'playlist';
            
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.querySelectorAll('.playlist-item').forEach(i => i.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            renderContent();
        }

        function addSongToPlaylist(playlistId) {
            const playlist = playlists.find(p => p.id === playlistId);
            if (playlist && !playlist.songs.includes(selectedSongForPlaylist)) {
                playlist.songs.push(selectedSongForPlaylist);
                savePlaylists();
                renderContent();
            }
            closeAddToPlaylistModal();
        }

        // Search
        function handleSearch() {
            searchTerm = document.getElementById('searchInput').value.toLowerCase();
            renderContent();
        }

        // Render Functions
        function renderPlaylists() {
            const container = document.getElementById('playlistsList');
            container.innerHTML = playlists.map(playlist => `
                <div class="playlist-item" onclick="viewPlaylist('${playlist.id}')">
                    <span>üìÅ ${playlist.name}</span>
                    <button class="delete-btn" onclick="event.stopPropagation(); deletePlaylist('${playlist.id}')">√ó</button>
                </div>
            `).join('');
        }

        function renderContent() {
            const container = document.getElementById('contentMain');
            let displaySongs = [];
            let title = '';
            let subtitle = '';
            
            if (currentView === 'all-songs') {
                displaySongs = songs;
                title = 'All Songs';
                subtitle = `${songs.length} song${songs.length !== 1 ? 's' : ''}`;
            } else if (currentView === 'favorites') {
                displaySongs = Array.from(favorites).map(id => songs.find(s => s.id === id)).filter(Boolean);
                title = '‚ù§Ô∏è Favorites';
                subtitle = `${displaySongs.length} song${displaySongs.length !== 1 ? 's' : ''}`;
            } else if (currentView === 'recent') {
                displaySongs = recentlyPlayed.map(id => songs.find(s => s.id === id)).filter(Boolean);
                title = 'üïê Recently Played';
                subtitle = `Last ${displaySongs.length} songs`;
            } else if (currentView === 'most-played') {
                displaySongs = songs
                    .map(song => ({ ...song, plays: playCount[song.id] || 0 }))
                    .filter(song => song.plays > 0)
                    .sort((a, b) => b.plays - a.plays);
                title = 'üî• Most Played';
                subtitle = 'Your top tracks';
            } else if (currentView === 'stats') {
                renderStatsView();
                return;
            } else if (currentView === 'recommendations') {
                renderRecommendationsView();
                return;
            } else if (currentView === 'history') {
                renderHistoryView();
                return;
            } else if (currentView === 'queue') {
                displaySongs = queue.map(id => songs.find(s => s.id === id)).filter(Boolean);
                title = 'Queue';
                subtitle = `${queue.length} song${queue.length !== 1 ? 's' : ''}`;
            } else if (currentView === 'playlist' && currentPlaylist) {
                const playlist = playlists.find(p => p.id === currentPlaylist);
                if (playlist) {
                    displaySongs = playlist.songs.map(id => songs.find(s => s.id === id)).filter(Boolean);
                    title = playlist.name;
                    subtitle = `${displaySongs.length} song${displaySongs.length !== 1 ? 's' : ''}`;
                }
            }
            
            if (searchTerm && (currentView === 'all-songs' || currentView === 'favorites' || currentView === 'recent')) {
                displaySongs = displaySongs.filter(song =>
                    song.name.toLowerCase().includes(searchTerm) ||
                    song.artist.toLowerCase().includes(searchTerm)
                );
            }
            
            container.innerHTML = `
                <div class="content-header">
                    <h1>${title}</h1>
                    <p>${subtitle}</p>
                </div>
                ${displaySongs.length === 0 ? `
                    <div class="empty-state">
                        <h3>No songs found</h3>
                        <p>${searchTerm ? 'Try a different search term' : currentView === 'favorites' ? 'Heart songs to add them here!' : currentView === 'most-played' ? 'Play some songs to see your favorites!' : 'Add some songs to get started'}</p>
                        ${!searchTerm && currentView === 'all-songs' ? '<button class="btn-primary" onclick="openAddSongModal()">+ Add Your First Song</button>' : ''}
                    </div>
                ` : `
                    <div class="songs-grid">
                        ${displaySongs.map((song, index) => {
                            const isFavorite = favorites.has(song.id);
                            const plays = playCount[song.id] || 0;
                            const hasAlbumArt = albumArtCache[song.id];
                            return `
                            <div class="song-card ${currentSongIndex !== -1 && songs[currentSongIndex].id === song.id ? 'playing' : ''}" onclick="playSong('${song.id}')">
                                ${currentView === 'most-played' ? `<div style="position: absolute; top: 12px; left: 12px; font-size: 24px; font-weight: 700; color: var(--primary); z-index: 10;">#${index + 1}</div>` : ''}
                                ${hasAlbumArt ? `<div style="width: 100%; height: 120px; background: url('${hasAlbumArt}') center/cover; border-radius: 8px 8px 0 0; margin: -20px -20px 12px -20px;"></div>` : ''}
                                <div class="song-info">
                                    <h3>${song.name} ${isFavorite ? '‚ù§Ô∏è' : ''}</h3>
                                    <p>${song.artist}</p>
                                    <span class="song-type ${song.type}">${
                                        song.type === 'local' ? (song.isVideo ? 'Video' : 'Local') : 
                                        song.type === 'youtube' ? 'YouTube' : 'Embed'
                                    }</span>
                                    ${plays > 0 ? `<span class="song-type" style="background: var(--surface-elevated); color: var(--text-secondary); margin-left: 4px;">${plays} plays</span>` : ''}
                                </div>
                                <div class="song-actions">
                                    <button onclick="event.stopPropagation(); toggleSongFavorite('${song.id}')">${isFavorite ? 'üíî Unfavorite' : '‚ù§Ô∏è Favorite'}</button>
                                    <button onclick="event.stopPropagation(); openLyricsModal('${song.id}')">üé§ Lyrics</button>
                                    <button onclick="event.stopPropagation(); openAddToPlaylistModal('${song.id}')">Add to Playlist</button>
                                    <button onclick="event.stopPropagation(); deleteSong('${song.id}')">Delete</button>
                                </div>
                            </div>
                        `}).join('')}
                    </div>
                `}
            `;
        }

        function renderStatsView() {
            const container = document.getElementById('contentMain');
            const totalPlays = Object.values(playCount).reduce((sum, count) => sum + count, 0);
            const totalSongs = songs.length;
            const totalFavorites = favorites.size;
            const avgPlaysPerSong = totalSongs > 0 ? (totalPlays / totalSongs).toFixed(1) : 0;
            
            const topSongs = songs
                .map(song => ({ ...song, plays: playCount[song.id] || 0 }))
                .filter(song => song.plays > 0)
                .sort((a, b) => b.plays - a.plays)
                .slice(0, 10);
            
            const maxPlays = topSongs.length > 0 ? topSongs[0].plays : 1;
            
            container.innerHTML = `
                <div class="content-header">
                    <h1>üìä Your Stats</h1>
                    <p>Listening insights</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-bottom: 40px;">
                    <div style="background: linear-gradient(135deg, var(--surface), var(--surface-elevated)); border: 1px solid var(--border); border-radius: 16px; padding: 24px; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="font-size: 36px; margin-bottom: 12px;">üéß</div>
                        <div style="font-size: 36px; font-weight: 700; margin-bottom: 4px;">${totalPlays}</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">Total Plays</div>
                    </div>
                    <div style="background: linear-gradient(135deg, var(--surface), var(--surface-elevated)); border: 1px solid var(--border); border-radius: 16px; padding: 24px; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="font-size: 36px; margin-bottom: 12px;">üéµ</div>
                        <div style="font-size: 36px; font-weight: 700; margin-bottom: 4px;">${totalSongs}</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">Songs in Library</div>
                    </div>
                    <div style="background: linear-gradient(135deg, var(--surface), var(--surface-elevated)); border: 1px solid var(--border); border-radius: 16px; padding: 24px; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="font-size: 36px; margin-bottom: 12px;">‚ù§Ô∏è</div>
                        <div style="font-size: 36px; font-weight: 700; margin-bottom: 4px;">${totalFavorites}</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">Favorite Songs</div>
                    </div>
                    <div style="background: linear-gradient(135deg, var(--surface), var(--surface-elevated)); border: 1px solid var(--border); border-radius: 16px; padding: 24px; transition: all 0.3s;" onmouseover="this.style.transform='translateY(-4px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="font-size: 36px; margin-bottom: 12px;">üìà</div>
                        <div style="font-size: 36px; font-weight: 700; margin-bottom: 4px;">${avgPlaysPerSong}</div>
                        <div style="font-size: 14px; color: var(--text-secondary);">Avg Plays/Song</div>
                    </div>
                </div>

                ${topSongs.length > 0 ? `
                    <div class="content-header" style="margin-top: 40px;">
                        <h2>üèÜ Top 10 Most Played</h2>
                        <p>Your favorite tracks ranked</p>
                    </div>
                    <div style="margin-top: 24px;">
                        ${topSongs.map((song, index) => `
                            <div style="display: flex; align-items: center; gap: 16px; padding: 20px; background: var(--surface); border: 1px solid var(--border); border-radius: 12px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s;" onclick="playSong('${song.id}')" onmouseover="this.style.transform='translateX(4px)'; this.style.borderColor='var(--primary)'" onmouseout="this.style.transform='translateX(0)'; this.style.borderColor='var(--border)'">
                                <div style="font-size: 32px; font-weight: 700; color: var(--primary); min-width: 48px; text-align: center;">
                                    ${index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '#' + (index + 1)}
                                </div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; font-size: 16px; margin-bottom: 4px;">${song.name} ${favorites.has(song.id) ? '‚ù§Ô∏è' : ''}</div>
                                    <div style="font-size: 13px; color: var(--text-secondary);">${song.artist}</div>
                                </div>
                                <div style="text-align: right; min-width: 120px;">
                                    <div style="font-weight: 700; font-size: 18px; color: var(--primary); margin-bottom: 4px;">${song.plays} plays</div>
                                    <div style="width: 100%; height: 8px; background: var(--surface-elevated); border-radius: 4px; overflow: hidden;">
                                        <div style="height: 100%; background: linear-gradient(135deg, var(--primary), var(--accent)); width: ${(song.plays / maxPlays) * 100}%; border-radius: 4px; transition: width 0.3s;"></div>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                ` : '<div class="empty-state" style="margin-top: 40px;"><h3>No play data yet</h3><p>Start listening to see your stats!</p></div>'}
            `;
        }

        function renderRecommendationsView() {
            const container = document.getElementById('contentMain');
            
            // Get songs user hasn't played much
            const allSongIds = songs.map(s => s.id);
            const leastPlayed = allSongIds
                .filter(id => (playCount[id] || 0) < 3)
                .map(id => songs.find(s => s.id === id))
                .filter(Boolean)
                .slice(0, 10);
            
            // Get songs similar to favorites (same type as favorites for now)
            const favoriteSongs = Array.from(favorites).map(id => songs.find(s => s.id === id)).filter(Boolean);
            const favoriteTypes = new Set(favoriteSongs.map(s => s.type));
            const similarToFavorites = songs
                .filter(s => !favorites.has(s.id) && favoriteTypes.has(s.type))
                .slice(0, 10);
            
            container.innerHTML = `
                <div class="content-header">
                    <h1>üéØ Recommendations</h1>
                    <p>Discover new songs based on your taste</p>
                </div>

                ${leastPlayed.length > 0 ? `
                    <div class="content-header" style="margin-top: 32px;">
                        <h2>üÜï Songs You Haven't Explored</h2>
                        <p>Give these tracks a try!</p>
                    </div>
                    <div class="songs-grid">
                        ${leastPlayed.map(song => {
                            const isFavorite = favorites.has(song.id);
                            const plays = playCount[song.id] || 0;
                            const hasAlbumArt = albumArtCache[song.id];
                            return `
                            <div class="song-card" onclick="playSong('${song.id}')">
                                ${hasAlbumArt ? `<div style="width: 100%; height: 120px; background: url('${hasAlbumArt}') center/cover; border-radius: 8px 8px 0 0; margin: -20px -20px 12px -20px;"></div>` : ''}
                                <div class="song-info">
                                    <h3>${song.name} ${isFavorite ? '‚ù§Ô∏è' : ''}</h3>
                                    <p>${song.artist}</p>
                                    <span class="song-type ${song.type}">${song.type === 'local' ? 'Local' : song.type === 'youtube' ? 'YouTube' : 'Embed'}</span>
                                </div>
                            </div>
                        `}).join('')}
                    </div>
                ` : ''}

                ${similarToFavorites.length > 0 && favorites.size > 0 ? `
                    <div class="content-header" style="margin-top: 40px;">
                        <h2>üí° Based On Your Favorites</h2>
                        <p>Similar songs you might like</p>
                    </div>
                    <div class="songs-grid">
                        ${similarToFavorites.map(song => {
                            const isFavorite = favorites.has(song.id);
                            const hasAlbumArt = albumArtCache[song.id];
                            return `
                            <div class="song-card" onclick="playSong('${song.id}')">
                                ${hasAlbumArt ? `<div style="width: 100%; height: 120px; background: url('${hasAlbumArt}') center/cover; border-radius: 8px 8px 0 0; margin: -20px -20px 12px -20px;"></div>` : ''}
                                <div class="song-info">
                                    <h3>${song.name} ${isFavorite ? '‚ù§Ô∏è' : ''}</h3>
                                    <p>${song.artist}</p>
                                    <span class="song-type ${song.type}">${song.type === 'local' ? 'Local' : song.type === 'youtube' ? 'YouTube' : 'Embed'}</span>
                                </div>
                            </div>
                        `}).join('')}
                    </div>
                ` : ''}

                ${leastPlayed.length === 0 && similarToFavorites.length === 0 ? `
                    <div class="empty-state">
                        <h3>No recommendations yet</h3>
                        <p>Add more songs and start listening to get personalized recommendations!</p>
                    </div>
                ` : ''}
            `;
        }

        function renderHistoryView() {
            const container = document.getElementById('contentMain');
            
            const groupedByDate = {};
            playHistoryTimeline.slice().reverse().forEach(entry => {
                const date = new Date(entry.timestamp).toLocaleDateString();
                if (!groupedByDate[date]) groupedByDate[date] = [];
                groupedByDate[date].push(entry);
            });
            
            container.innerHTML = `
                <div class="content-header">
                    <h1>‚è±Ô∏è Play History Timeline</h1>
                    <p>Your listening history over time</p>
                </div>

                ${Object.keys(groupedByDate).length > 0 ? `
                    ${Object.keys(groupedByDate).map(date => `
                        <div style="margin-top: 32px;">
                            <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 16px; color: var(--primary);">üìÖ ${date}</h3>
                            ${groupedByDate[date].map(entry => {
                                const time = new Date(entry.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                                return `
                                <div style="display: flex; align-items: center; gap: 16px; padding: 16px; background: var(--surface); border: 1px solid var(--border); border-radius: 12px; margin-bottom: 8px; cursor: pointer; transition: all 0.2s;" onclick="playSong('${entry.songId}')" onmouseover="this.style.transform='translateX(4px)'" onmouseout="this.style.transform='translateX(0)'">
                                    <div style="font-size: 14px; font-weight: 600; color: var(--text-secondary); min-width: 60px;">${time}</div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 600; margin-bottom: 2px;">${entry.songName}</div>
                                        <div style="font-size: 13px; color: var(--text-secondary);">${entry.artist}</div>
                                    </div>
                                    <div style="font-size: 24px;">‚ñ∂Ô∏è</div>
                                </div>
                            `}).join('')}
                        </div>
                    `).join('')}
                ` : `
                    <div class="empty-state">
                        <h3>No play history yet</h3>
                        <p>Start listening to songs to see your timeline!</p>
                    </div>
                `}
            `;
        }

        // Storage
        function saveSongsMeta() {
            try {
                localStorage.setItem('musicAppSongsMeta', JSON.stringify(songs));
                localStorage.setItem('musicAppFavorites', JSON.stringify(Array.from(favorites)));
                localStorage.setItem('musicAppRecent', JSON.stringify(recentlyPlayed));
                localStorage.setItem('musicAppPlayCount', JSON.stringify(playCount));
                localStorage.setItem('musicAppVolumeBoost', volumeBoostEnabled.toString());
                localStorage.setItem('musicAppAlbumArt', JSON.stringify(albumArtCache));
                localStorage.setItem('musicAppLyrics', JSON.stringify(songLyrics));
                localStorage.setItem('musicAppTimeline', JSON.stringify(playHistoryTimeline.slice(-100))); // Keep last 100 entries
            } catch (error) {
                console.error('Error saving songs metadata:', error);
                alert('Error saving songs. Storage may be full.');
            }
        }

        function savePlaylists() {
            try {
                localStorage.setItem('musicAppPlaylists', JSON.stringify(playlists));
            } catch (error) {
                console.error('Error saving playlists:', error);
            }
        }

        // Settings Modal Functions
        function openSettingsModal() {
            document.getElementById('settingsModal').classList.add('active');
            // Sync settings with current values
            document.getElementById('darkModeToggle').checked = isDarkMode;
            document.getElementById('themeSelectSettings').value = currentTheme;
            document.getElementById('autoplayToggle').checked = autoplayEnabled;
            document.getElementById('volumeBoostToggle').checked = volumeBoostEnabled;
            document.getElementById('defaultVolumeSlider').value = volume * 100;
            document.getElementById('volumePercentage').textContent = Math.round(volume * 100) + '%';
            document.getElementById('crossfadeSelect').value = crossfadeDuration.toString();
            document.getElementById('qualitySelect').value = streamingQuality;
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function switchSettingsTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.settings-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update content
            document.querySelectorAll('.settings-content').forEach(content => {
                content.style.display = 'none';
            });
            
            if (tabName === 'general') {
                document.getElementById('generalSettings').style.display = 'block';
            } else if (tabName === 'playback') {
                document.getElementById('playbackSettings').style.display = 'block';
            } else if (tabName === 'about') {
                document.getElementById('aboutSettings').style.display = 'block';
            }
        }

        function toggleModeFromSettings() {
            isDarkMode = document.getElementById('darkModeToggle').checked;
            localStorage.setItem('musicAppMode', isDarkMode ? 'dark' : 'light');
            applyTheme();
        }

        function changeThemeFromSettings() {
            currentTheme = document.getElementById('themeSelectSettings').value;
            localStorage.setItem('musicAppTheme', currentTheme);
            applyTheme();
            document.getElementById('themeSelector').value = currentTheme;
        }

        function toggleAutoplay() {
            autoplayEnabled = document.getElementById('autoplayToggle').checked;
            localStorage.setItem('musicAppAutoplay', autoplayEnabled.toString());
        }

        function toggleVolumeBoost() {
            volumeBoostEnabled = document.getElementById('volumeBoostToggle').checked;
            applyVolumeBoost();
            saveSongsMeta();
        }

        function applyVolumeBoost() {
            if (volumeBoostEnabled) {
                audioPlayer.volume = Math.min(1.0, volume * 1.5);
                videoPlayer.volume = Math.min(1.0, volume * 1.5);
            } else {
                audioPlayer.volume = volume;
                videoPlayer.volume = volume;
            }
        }

        function updateDefaultVolume() {
            const slider = document.getElementById('defaultVolumeSlider');
            volume = slider.value / 100;
            audioPlayer.volume = volume;
            videoPlayer.volume = volume;
            document.getElementById('volumePercentage').textContent = slider.value + '%';
            document.getElementById('volumeFill').style.width = slider.value + '%';
            localStorage.setItem('musicAppVolume', volume.toString());
        }

        function updateCrossfade() {
            crossfadeDuration = parseInt(document.getElementById('crossfadeSelect').value);
            localStorage.setItem('musicAppCrossfade', crossfadeDuration.toString());
        }

        function updateQuality() {
            streamingQuality = document.getElementById('qualitySelect').value;
            localStorage.setItem('musicAppQuality', streamingQuality);
        }

        // Export/Import Library
        function exportLibrary() {
            const exportData = {
                songs: songs,
                playlists: playlists,
                favorites: Array.from(favorites),
                recentlyPlayed: recentlyPlayed,
                playCount: playCount,
                albumArtCache: albumArtCache,
                settings: {
                    isDarkMode,
                    currentTheme,
                    autoplayEnabled,
                    volumeBoostEnabled,
                    volume,
                    crossfadeDuration,
                    streamingQuality
                },
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `musica-library-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('‚úÖ Library exported successfully!');
        }

        function importLibrary() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                try {
                    const text = await file.text();
                    const importData = JSON.parse(text);
                    
                    if (confirm('‚ö†Ô∏è This will replace your current library. Continue?')) {
                        songs = importData.songs || [];
                        playlists = importData.playlists || [];
                        favorites = new Set(importData.favorites || []);
                        recentlyPlayed = importData.recentlyPlayed || [];
                        playCount = importData.playCount || {};
                        albumArtCache = importData.albumArtCache || {};
                        
                        if (importData.settings) {
                            isDarkMode = importData.settings.isDarkMode;
                            currentTheme = importData.settings.currentTheme;
                            autoplayEnabled = importData.settings.autoplayEnabled;
                            volumeBoostEnabled = importData.settings.volumeBoostEnabled;
                            volume = importData.settings.volume;
                            crossfadeDuration = importData.settings.crossfadeDuration;
                            streamingQuality = importData.settings.streamingQuality;
                        }
                        
                        saveSongsMeta();
                        savePlaylists();
                        applyTheme();
                        renderContent();
                        renderPlaylists();
                        
                        alert('‚úÖ Library imported successfully!');
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    alert('‚ùå Error importing library. Please check the file format.');
                }
            };
            input.click();
        }

        function clearAllData() {
            if (!confirm('Are you sure you want to delete ALL data? This will remove all songs, playlists, and settings. This action cannot be undone!')) {
                return;
            }
            
            if (!confirm('This is your last warning. All data will be permanently deleted. Continue?')) {
                return;
            }
            
            // Clear IndexedDB
            indexedDB.deleteDatabase(DB_NAME);
            
            // Clear localStorage
            localStorage.removeItem('musicAppSongsMeta');
            localStorage.removeItem('musicAppPlaylists');
            localStorage.removeItem('musicAppMode');
            localStorage.removeItem('musicAppTheme');
            localStorage.removeItem('musicAppAutoplay');
            localStorage.removeItem('musicAppVolume');
            localStorage.removeItem('musicAppCrossfade');
            localStorage.removeItem('musicAppQuality');
            localStorage.removeItem('musicAppFavorites');
            localStorage.removeItem('musicAppRecent');
            localStorage.removeItem('musicAppPlayCount');
            localStorage.removeItem('musicAppVolumeBoost');
            localStorage.removeItem('musicAppAlbumArt');
            localStorage.removeItem('musicAppLyrics');
            localStorage.removeItem('musicAppTimeline');
            
            alert('All data cleared successfully. The page will now reload.');
            window.location.reload();
        }

        // Lyrics Functions
        let currentLyricsSongId = null;

        function openLyricsModal(songId) {
            currentLyricsSongId = songId;
            const song = songs.find(s => s.id === songId);
            if (!song) return;
            
            document.getElementById('lyricsInfo').innerHTML = `
                <strong style="font-size: 16px;">${song.name}</strong><br>
                <span style="color: var(--text-secondary);">${song.artist}</span>
            `;
            
            document.getElementById('lyricsTextarea').value = songLyrics[songId] || '';
            document.getElementById('lyricsModal').classList.add('active');
        }

        function closeLyricsModal() {
            document.getElementById('lyricsModal').classList.remove('active');
            currentLyricsSongId = null;
        }

        function saveLyrics() {
            if (!currentLyricsSongId) return;
            
            const lyrics = document.getElementById('lyricsTextarea').value.trim();
            if (lyrics) {
                songLyrics[currentLyricsSongId] = lyrics;
            } else {
                delete songLyrics[currentLyricsSongId];
            }
            
            saveSongsMeta();
            closeLyricsModal();
            alert('‚úÖ Lyrics saved!');
        }

        // NEW: Favorite Functions
        function toggleFavorite() {
            if (currentSongIndex === -1) return;
            
            const songId = songs[currentSongIndex].id;
            if (favorites.has(songId)) {
                favorites.delete(songId);
            } else {
                favorites.add(songId);
            }
            
            updateFavoriteButton();
            saveSongsMeta();
            if (currentView === 'favorites') {
                renderContent();
            }
        }

        function toggleSongFavorite(songId) {
            if (favorites.has(songId)) {
                favorites.delete(songId);
            } else {
                favorites.add(songId);
            }
            
            saveSongsMeta();
            renderContent();
            if (currentSongIndex !== -1 && songs[currentSongIndex].id === songId) {
                updateFavoriteButton();
            }
        }

        function updateFavoriteButton() {
            if (currentSongIndex === -1) return;
            const isFavorite = favorites.has(songs[currentSongIndex].id);
            const btn = document.getElementById('favoriteBtn');
            btn.textContent = isFavorite ? 'üíî Unfavorite' : '‚ù§Ô∏è Favorite';
            btn.style.background = isFavorite ? 'linear-gradient(135deg, var(--primary), var(--accent))' : 'var(--surface-elevated)';
            btn.style.color = isFavorite ? 'white' : 'var(--text)';
            btn.style.borderColor = isFavorite ? 'var(--primary)' : 'var(--border)';
        }

        // Keyboard Shortcuts
        document.addEventListener('keydown', (e) => {
            // Don't trigger shortcuts when typing in input fields
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                return;
            }
            
            switch(e.key.toLowerCase()) {
                case ' ':
                    e.preventDefault();
                    togglePlayPause();
                    break;
                case 'arrowright':
                    e.preventDefault();
                    nextSong();
                    break;
                case 'arrowleft':
                    e.preventDefault();
                    previousSong();
                    break;
                case 'arrowup':
                    e.preventDefault();
                    volume = Math.min(1, volume + 0.1);
                    audioPlayer.volume = volume;
                    videoPlayer.volume = volume;
                    document.getElementById('volumeFill').style.width = (volume * 100) + '%';
                    break;
                case 'arrowdown':
                    e.preventDefault();
                    volume = Math.max(0, volume - 0.1);
                    audioPlayer.volume = volume;
                    videoPlayer.volume = volume;
                    document.getElementById('volumeFill').style.width = (volume * 100) + '%';
                    break;
                case 'm':
                    toggleMute();
                    break;
                case 's':
                    toggleShuffle();
                    break;
                case 'r':
                    toggleLoop();
                    break;
            }
        });

        // Start the app
        init();
    </script>
</body>
</html>
